<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>On the role of dopamine in motivated behavior : a neuro-computational approach - 4&nbsp; Working memory and response selection: A computational account of interactions among cortico-basal ganglio-thalamic loops</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./5-FINR.html" rel="next">
<link href="./3-FICN.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./4-NN.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working memory and response selection: A computational account of interactions among cortico-basal ganglio-thalamic loops</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./img/tuc.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">On the role of dopamine in motivated behavior : a neuro-computational approach</a> 
        <div class="sidebar-tools-main">
    <a href="./thesis.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-JOCN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Sustained activities and retrieval in a computational model of perirhinal cortex</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-FICN.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A computational model of basal ganglia and its role in memory retrieval in rewarded visual memory tasks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-NN.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working memory and response selection: A computational account of interactions among cortico-basal ganglio-thalamic loops</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-FINR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Timing and expectation of reward: a neuro-computational model of the afferents to the ventral tegmental area</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-FINI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ANNarchy: a code generation approach to neural simulations on parallel hardware</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./References.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#material-and-methods" id="toc-material-and-methods" class="nav-link" data-scroll-target="#material-and-methods"><span class="header-section-number">4.2</span> Material and methods</a>
  <ul class="collapse">
  <li><a href="#sec-nn:architecture" id="toc-sec-nn:architecture" class="nav-link" data-scroll-target="#sec-nn\:architecture"><span class="header-section-number">4.2.1</span> Architecture of the model</a></li>
  <li><a href="#sec-nn:setup" id="toc-sec-nn:setup" class="nav-link" data-scroll-target="#sec-nn\:setup"><span class="header-section-number">4.2.2</span> Experimental setups</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">4.3</span> Results</a>
  <ul class="collapse">
  <li><a href="#task-performance" id="toc-task-performance" class="nav-link" data-scroll-target="#task-performance"><span class="header-section-number">4.3.1</span> Task performance</a></li>
  <li><a href="#sec-nn:analysis" id="toc-sec-nn:analysis" class="nav-link" data-scroll-target="#sec-nn\:analysis"><span class="header-section-number">4.3.2</span> Analysis of the model’s behavior</a></li>
  </ul></li>
  <li><a href="#sec-nn:discussion" id="toc-sec-nn:discussion" class="nav-link" data-scroll-target="#sec-nn\:discussion"><span class="header-section-number">4.4</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#appendix-a.-full-list-of-equations" id="toc-appendix-a.-full-list-of-equations" class="nav-link" data-scroll-target="#appendix-a.-full-list-of-equations">Appendix A. Full list of equations</a></li>
  <li><a href="#appendix-b.-number-of-simulated-cells" id="toc-appendix-b.-number-of-simulated-cells" class="nav-link" data-scroll-target="#appendix-b.-number-of-simulated-cells">Appendix B. Number of simulated cells</a></li>
  <li><a href="#appendix-c.-overview-of-model-parameters" id="toc-appendix-c.-overview-of-model-parameters" class="nav-link" data-scroll-target="#appendix-c.-overview-of-model-parameters">Appendix C. Overview of model parameters</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-chapter:WM" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working memory and response selection: A computational account of interactions among cortico-basal ganglio-thalamic loops</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="abstract" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="abstract">Abstract</h4>
<p>Cortico-basal ganglio-thalamic loops are involved in both cognitive processes and motor control. We present a biologically meaningful computational model of how these loops contribute to the organization of working memory and the development of response behavior. Via reinforcement learning in basal ganglia, the model develops flexible control of working memory within prefrontal loops and achieves selection of appropriate responses based on working memory content and visual stimulation within a motor loop. We show that both working memory control and response selection can evolve within parallel and interacting cortico-basal ganglio-thalamic loops by Hebbian and three-factor learning rules. Furthermore, the model gives a coherent explanation for how complex strategies of working memory control and response selection can derive from basic cognitive operations that can be learned via trial and error.</p>
</section>
<section id="introduction" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">4.1</span> Introduction</h2>
<p>Working memory (WM) is a key prerequisite for planning and executing responses. In a prominent notion <span class="citation" data-cites="Repovs2006">(<a href="References.html#ref-Repovs2006" role="doc-biblioref">Repovs and Baddeley, 2006</a>)</span>, WM consists of the capability to maintain information over limited periods of time and the ability to manipulate that information. By maintaining information in WM, an organism can detach its responses from its immediate sensory environment and exert deliberate control over its actions. Healthy human adults demonstrate an enormous flexibility in WM control in that WM is eligible for a tremendous multitude of stimuli, each of which can be maintained over adjustable periods of time and manipulated in various ways. However, that flexibility has to be acquired meticulously over many years of childhood and adolescence. In the early years of childhood, even WM tasks as simple as a Delayed-Match-to-Sample task pose a serious challenge <span class="citation" data-cites="Luciana1998">(<a href="References.html#ref-Luciana1998" role="doc-biblioref">Luciana and Nelson, 1998</a>)</span>.</p>
<p>While several brain structures have been shown to contribute to WM and response selection <span class="citation" data-cites="Bird2008 Bunge2002 Jonides1998 McNab2008 Rowe2000">(cf. <a href="References.html#ref-Bird2008" role="doc-biblioref">Bird and Burgess, 2008</a>; <a href="References.html#ref-Bunge2002" role="doc-biblioref">Bunge et al., 2002</a>; <a href="References.html#ref-Jonides1998" role="doc-biblioref">Jonides et al., 1998</a>; <a href="References.html#ref-McNab2008" role="doc-biblioref">McNab and Klingberg, 2008</a>; <a href="References.html#ref-Rowe2000" role="doc-biblioref">Rowe et al., 2000</a>)</span>, we here focus on the role of basal ganglia (BG) as part of a looped cortico-BG-thalamic architecture: closed cortico-BG-thalamic loops, connecting a particular area of cortex to itself, can be anatomically distinguished from open loops, linking in an ascending manner areas involved in motivation, cognition and motor execution <span class="citation" data-cites="Haber2003 Voorn2004">(<a href="References.html#ref-Haber2003" role="doc-biblioref">Haber, 2003</a>; <a href="References.html#ref-Voorn2004" role="doc-biblioref">Voorn et al., 2004</a>)</span>. This architecture of parallel and hierarchically interconnected loops provides a potential anatomic substrate for both WM processes and response selection: closed loops allow maintaining information for extended periods of time and flexibly updating it (i.e.&nbsp;two major WM processes); open loops allow information that is maintained in hierarchically superior WM loops to bias response selection within hierarchically inferior motor loops <span class="citation" data-cites="Haber2003">(cf. <a href="References.html#ref-Haber2003" role="doc-biblioref">Haber, 2003</a>)</span>.</p>
<p>With regard to plasticity, BG are assumed to take part in visual and motor category learning <span class="citation" data-cites="Seger2008">(<a href="References.html#ref-Seger2008" role="doc-biblioref">Seger, 2008</a>)</span> and in establishing associations between stimuli and responses <span class="citation" data-cites="Packard2002">(<a href="References.html#ref-Packard2002" role="doc-biblioref">Packard and Knowlton, 2002</a>)</span>. Probably most eminently, they are believed to have an important role in reinforcement learning: BG receive dopaminergic afferents from substantia nigra pars compacta (SNc), a nucleus of the midbrain, that provides them with an error signal of reward prediction <span class="citation" data-cites="Hollerman1998 Schultz1997">(<a href="References.html#ref-Hollerman1998" role="doc-biblioref">Hollerman and Schultz, 1998</a>; <a href="References.html#ref-Schultz1997" role="doc-biblioref">Schultz et al., 1997</a>)</span>: Relative to a tonic baseline dopamine emission of nigral neurons, dopamine bursts result from unexpected rewards and from reward-predicting stimuli while dopamine depletions follow omissions of expected rewards. Dopamine levels have been shown to modulate long-term synaptic plasticity within BG, especially in its major input structure, the striatum <span class="citation" data-cites="Reynolds2001 Shen2008">(<a href="References.html#ref-Reynolds2001" role="doc-biblioref">Reynolds et al., 2001</a>; <a href="References.html#ref-Shen2008" role="doc-biblioref">Shen et al., 2008</a>)</span>.</p>
<p>In recent years, several computational models of BG functions have been developed, pinpointing their role in WM and motor control <span class="citation" data-cites="Ashby2007 Brown2004 Gurney2001 OReilly2006 Vitay2010">(<a href="References.html#ref-Ashby2007" role="doc-biblioref">Ashby et al., 2007</a>; <a href="References.html#ref-Brown2004" role="doc-biblioref">Brown et al., 2004</a>; <a href="References.html#ref-Gurney2001" role="doc-biblioref">Gurney et al., 2001</a>; <a href="References.html#ref-OReilly2006" role="doc-biblioref">O’Reilly and Frank, 2006</a>; <a href="References.html#ref-Vitay2010" role="doc-biblioref">Vitay and Hamker, 2010</a>)</span>. It has been shown that reinforcement learning mechanisms within biologically inspired cortico-BG-thalamic loops can solve conditional Delayed-Match-to-Sample and Delayed-Paired-Association tasks <span class="citation" data-cites="Vitay2010">(<a href="References.html#ref-Vitay2010" role="doc-biblioref">Vitay and Hamker, 2010</a>)</span> and the 1-2-AX task of WM <span class="citation" data-cites="OReilly2006">(<a href="References.html#ref-OReilly2006" role="doc-biblioref">O’Reilly and Frank, 2006</a>)</span>. Moreover, it has been proven that shaping <span class="citation" data-cites="Skinner1938">(i.e.&nbsp;a procedure of teaching a task via successively more complex approximations, <a href="References.html#ref-Skinner1938" role="doc-biblioref">Skinner, 1938</a>)</span> can provide computational models with benefits to learn demanding WM tasks <span class="citation" data-cites="Krueger2009">(<a href="References.html#ref-Krueger2009" role="doc-biblioref">Krueger and Dayan, 2009</a>)</span>: notably, shaping can speed up the learning process and provide sub-strategies to an agent that can later be used to cope with similar problems. In animal training and human education, shaping is a standard procedure to guarantee learning of complex behaviors: conditional WM tasks like the 1-2-AX task would not be trainable to animals or infant humans without such a procedure.</p>
<p>Given the huge variety of functions that BG contribute to and the multitude of brain areas that they interact with, a fundamental question in BG research is how different BG loops coherently interact. Here we follow a model-driven approach to gain insight into how dopamine-modulated learning in BG controls a combined WM-response selection system acting within different cortico-BG-thalamic loops. We propose a single set of Hebbian and three-factor learning rules for two different levels of the cortico-BG-thalamic hierarchy: prefrontal loops learn to flexibly switch between WM update and WM maintenance and a hierarchically inferior motor loop learns selection of rewarded responses based on WM content and visual stimulation. Our model’s functional abilities are demonstrated on delayed response (DR) tasks, a delayed alternation (DA) task and on the 1-2-AX task of WM <span class="citation" data-cites="OReilly2006">(<a href="References.html#ref-OReilly2006" role="doc-biblioref">O’Reilly and Frank, 2006</a>)</span>, the latter being trained in a three-step shaping procedure. We provide interpretations of the roles of BG pathways in WM control and response selection and propose a mechanism of how task monitoring for unexpected errors instigates learning processes. The purpose of our approach is to show how reinforcement learning processes within separate but interconnected cortico-BG-thalamic loops can in parallel establish WM control and response selection.</p>
</section>
<section id="material-and-methods" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="material-and-methods"><span class="header-section-number">4.2</span> Material and methods</h2>
<section id="sec-nn:architecture" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="sec-nn:architecture"><span class="header-section-number">4.2.1</span> Architecture of the model</h3>
<p>BG loops can be classified according to their contributions to different functional domains <span class="citation" data-cites="Alexander1986">(<a href="References.html#ref-Alexander1986" role="doc-biblioref">Alexander et al., 1986</a>)</span>: loops traversing the caudate nucleus and lateral prefrontal cortex contribute to the executive domain. They are involved in goal-directed learning, action-outcome associations and WM <span class="citation" data-cites="Redgrave2010">(<a href="References.html#ref-Redgrave2010" role="doc-biblioref">Redgrave et al., 2010</a>)</span>; loops traversing the putamen as well as premotor and sensorimotor cortices contribute to the motor domain and are involved in action selection, stimulus-response associations and habitual control <span class="citation" data-cites="Horvitz2009">(<a href="References.html#ref-Horvitz2009" role="doc-biblioref">Horvitz, 2009</a>)</span>. Different types of loops interact through various kinds of fibers <span class="citation" data-cites="Haber2003">(<a href="References.html#ref-Haber2003" role="doc-biblioref">Haber, 2003</a>)</span>. Among these fibers, cortico-striatal connections allow for a convergence of inputs from distinct frontal cortical areas onto key striatal regions <span class="citation" data-cites="Calzavara2007 Takada1998">(<a href="References.html#ref-Calzavara2007" role="doc-biblioref">Calzavara et al., 2007</a>; <a href="References.html#ref-Takada1998" role="doc-biblioref">Takada et al., 1998</a>)</span>. Thereby, these fibers create a hierarchy of information flow from the executive/prefrontal domain to the sensorimotor domain and provide a potential substrate for how cognitive processes guide motor processes <span class="citation" data-cites="Calzavara2007">(<a href="References.html#ref-Calzavara2007" role="doc-biblioref">Calzavara et al., 2007</a>)</span>. <a href="#fig-nn:fig1" class="quarto-xref">Figure&nbsp;<span>4.1</span></a> shows the general layout of our model which is consistent with cortico-BG-thalamic circuitry <span class="citation" data-cites="Braak2008 DeLong2007 Haber2003">(<a href="References.html#ref-Braak2008" role="doc-biblioref">Braak and Del Tredici, 2008</a>; <a href="References.html#ref-DeLong2007" role="doc-biblioref">DeLong and Wichmann, 2007</a>; <a href="References.html#ref-Haber2003" role="doc-biblioref">Haber, 2003</a>)</span>. The model consists of parallel and hierarchically interconnected cortico-BG-thalamic loops that all have the same general architecture and obey the same learning rules. Prefrontal cortico-BG-thalamic loops (as shown on the left of <a href="#fig-nn:fig1" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>) control WM by flexibly switching between maintenance and updating of information. They bias a motor loop (shown on the right of Fig. <a href="#fig-nn:fig1" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>) to decide between a set of possible responses. As previously motivated by others <span class="citation" data-cites="Krueger2009 OReilly2006">(e.g. <a href="References.html#ref-Krueger2009" role="doc-biblioref">Krueger and Dayan, 2009</a>; <a href="References.html#ref-OReilly2006" role="doc-biblioref">O’Reilly and Frank, 2006</a>)</span>, our model contains multiple independent prefrontal loops. While there is no upper limit to the number of loops that can be incorporated, we kept it as small as possible to minimize computational costs: two prefrontal loops are sufficient to have the model learn the tasks analyzed in this paper. Differential recruitment of these loops is controlled by the pedunculopontine nucleus (PPN) as detailed in the corresponding subsection below.</p>
<div id="fig-nn:fig1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.1: Architecture of the proposed model: prefrontal cortico-BG-thalamic loops flexibly control WM and guide a motor loop to choose between a set of possible responses. While the general layout of prefrontal and motor loops is the same, the motor loop is simplified as explained in the main text. Boxes represent the different layers of the model, arrows the connections between them. ‘Double’ boxes represent dual prefrontal circuits. Solid arrows denote hard-coded connections between or within layers, dashed arrows learnable ones. Pointed arrows symbolize excitatory connections, rounded arrows inhibitory ones. The solid gray arrows deriving from SNc represent a modulatory ‘dopaminergic’ influence on learning within BG synapses. The dotted gray arrow from PPN to SNc denotes a ‘cholinergic’ recruitment of SNc neurons through PPN. Explanations are given in the main text. GPe: globus pallidus external segment; GPi: globus pallidus internal segment; lPFC: lateral prefrontal cortex; MI: primary motor cortex; ITC: inferior temporal cortex; PPN: pedunculopontine nucleus; SNc: substantia nigra pars compacta; STN: subthalamic nucleus.
</figcaption>
</figure>
</div>
<p>The general functional framework of our model is straightforward. During stimulus presentation, visual input is externally fed into inferior temporal cortex (ITC). Stimulus-related activity can then spread through the model and bias processing within prefrontal and motor loops. Motor responses are read out of primary motor cortex (MI) activity and rewarded if correct. When a reward is given, reward information is fed into SNc where an error signal of reward prediction is computed. From this error signal, BG learn to self-organize in such a way that the model’s responses maximize rewards.</p>
<p>The cortico-BG-thalamic loops’ functional architecture works as follows. Activation of cortex excites striatal and subthalamic neurons. Striatum then inhibits tonically active neurons of the internal segment of globus pallidus (GPi) via striato-pallidal connections that are usually referred to as the direct BG pathway. Decreases of GPi firing in turn disinhibit thalamic neurons that excitatorily connect back to cortex. In global terms, the direct pathway serves to establish WM maintenance within prefrontal loops by mapping cortical representations onto themselves. Within the motor loop, it links WM content to appropriate responses by mapping prefrontal-loop representations onto specific motor-loop representations. In contrast, activation of the subthalamic nucleus (STN) causes a strong and global excitation of GPi via subthalamo-pallidal fibers that are usually referred to as the hyperdirect pathway. As activity is spreading from STN to the external segment of globus pallidus (GPe), inhibitory GPe-GPi connections cancel the excitatory effects of STN on GPi. The hyperdirect pathway (which is modeled only in prefrontal loops) thus gives a brief and global reset pulse to GPi, allowing the respective loop to update. The interplay of the various layers will in detail be analyzed in <a href="#sec-nn:analysis" class="quarto-xref"><span>Section 4.3.2</span></a>.</p>
<p>In constructing the model, we included only those nuclei and pathways that were necessary to have the model perform response selection, WM maintenance and updating of WM. These functions are required by a set of prominent WM tasks (described in <a href="#sec-nn:setup" class="quarto-xref"><span>Section 4.2.2</span></a>). As detailed later in this section as well as in <a href="#sec-nn:analysis" class="quarto-xref"><span>Section 4.3.2</span></a>, we assume response selection to be subserved by the direct pathway of the motor loop, WM maintenance by the direct pathway of prefrontal loops and WM updating by the hyperdirect pathway of prefrontal loops. We did not model the hyperdirect pathway of the motor loop and the ‘indirect’ striato-GPe-GPi pathway (within neither loop). As detailed in <a href="#sec-nn:discussion" class="quarto-xref"><span>Section 4.4</span></a>, empirical evidence implicates these pathways in functions other than the ones targeted in this paper. To keep the motor loop simple, pallido-pallidal, cortico-thalamic and thalamo-cortical connections were rendered hard-coded instead of learnable. Importantly: wherever a nucleus is present in both types of loops, activities are computed via the same equations. And: wherever a connection is learnable in both types of loops, the learning rules are the same.</p>
<p>The mathematical implementation of our model is inspired by a previous model from our group <span class="citation" data-cites="Vitay2010">(<a href="References.html#ref-Vitay2010" role="doc-biblioref">Vitay and Hamker, 2010</a>)</span> that consists of a single-loop BG architecture without the ability to learn WM control: each of the modeled layers consists of dynamic, firing rate-coded neurons (exact numbers are reported in Table of the Appendix B). For each neuron, a membrane potential is determined via a differential equation, discretized according to the Euler method (first-order) with a time step of 1 ms; a cell-specific transfer function turns membrane potentials into firing rates. The differential equations are evaluated asynchronously to allow for stochastic interactions between functional units. As a general template, membrane potentials <span class="math inline">m^\text{post}_i(t)</span> are computed by the following differential equation:</p>
<p><span id="eq-nn:mp"><span class="math display">
    \tau \cdot \frac{d m^\text{post}_i(t)}{dt} + m^\text{post}_i(t) = \sum_{j \in \text{pre}} w_{i,j}^\text{pre-post}(t) \cdot u\text{pre}_j(t) + M + \epsilon_i(t)
\tag{4.1}</span></span></p>
<p>where <span class="math inline">\tau</span> is the time constant of postsynaptic cell $i,uprej(t) the firing rate of presynaptic cell $j,wpre-posti,j(t) the weight between these cells, MM a baseline parameter and <span class="math inline">\epsilon_i(t)</span> a random noise term. The noise term supports exploration of WM control and action selection by introducing independent random fluctuations to the membrane potentials of different cells. Firing rates <span class="math inline">u^\text{post}_i(t)</span> are computed from membrane potentials via cell-specific transfer functions <span class="math inline">f_u(x)</span>:</p>
<p><span id="eq-nn:u"><span class="math display">
    u^\text{post}_i(t)=f_u(m^\text{post}_i(t))
\tag{4.2}</span></span></p>
<p>As defined in Appendix A, <span class="math inline">f_u(x)</span> defines negative values to be set to zero and for some layers additionally specifies sigmoid functions.</p>
<p>Loops are not predetermined to represent particular stimuli: each prefrontal loop receives the same visual input and only by accumulating knowledge about its environment will it learn to encode certain stimuli and ignore others. <a href="#fig-nn:fig1" class="quarto-xref">Figure&nbsp;<span>4.1</span></a> depicts all learnable connections of the model by dashed arrows. As explained in detail in the next paragraphs, thalamo-cortical and cortico-thalamic learning is Hebbian-like whereas learning in BG relies on three-factor rules, involving a reward-related dopaminergic term <span class="citation" data-cites="Reynolds2002">(<a href="References.html#ref-Reynolds2002" role="doc-biblioref">Reynolds and Wickens, 2002</a>)</span>. Dopamine levels are controlled by SNc firing rates and encode an error signal of reward prediction.</p>
<p>Dopaminergic learning poses an obvious challenge on modeling: as stimuli are typically presented (and responses performed) some time before reward delivery, there will be a delay between concurrent activity of pre- and postsynaptic cells and the dopamine levels resulting from that activity. The brain’s probable solution to this problem are synapse-specific calcium eligibility traces: concurrent pre- and postsynaptic activities lead to a sudden rise in input-specific postsynaptic calcium concentrations (<span class="math inline">Ca^\text{post}_{i,j}(t)</span>) that decrease only slowly when concurrent activity ends.</p>
<p><span id="eq-nn:Ca"><span class="math display">
     \eta^\text{Ca} \cdot \frac{dCa^\text{post}_{i,j}(t)}{dt} + Ca^\text{post}_{i,j}(t) = f_\text{post}(u_i^\text{post}(t) - \overline{\text{post}}(t) - \gamma_\text{post}) \cdot f_\text{pre}(u_j^\text{pre}(t) - \overline{\text{pre}}(t) - \gamma_\text{pre})
\tag{4.3}</span></span></p>
<p><span id="eq-nn:etaCa"><span class="math display">
     \eta^\text{Ca} = \begin{cases}
                    \eta^\text{inc} \qquad \text{if } dCa^\text{post}_{i,j}(t) &gt; 0 \\
                    \eta^\text{dec} \qquad \text{else.} \\
                \end{cases}
\tag{4.4}</span></span></p>
<p><span class="math inline">\eta^\text{Ca}</span> is the time constant of the calcium trace, <span class="math inline">\overline{\text{pre}}(t)</span> the mean firing rate of afferent layer pre at time <span class="math inline">t</span>, <span class="math inline">\overline{\text{post}}(t)</span> the mean firing rate of postsynaptic layer post at time <span class="math inline">t</span>, <span class="math inline">\eta^\text{inc}</span> a parameter controlling the speed of calcium level increase and <span class="math inline">\eta^\text{dec}</span> a parameter controlling the speed of calcium level decline. <span class="math inline">\gamma_\text{pre}</span> and <span class="math inline">\gamma_\text{post}</span> allow to adjust thresholds for pre- and post-synaptic activities that separate between increases and decreases of calcium traces. Functions <span class="math inline">f_\text{pre}(x)</span> and <span class="math inline">f_\text{post}(x)</span> can restrict pre- and post-synaptic terms to positive values or introduce sigmoid functions as detailed in Appendix A. <span class="math inline">dCa^\text{post}_{i,j}(t)</span> gives a positive value when at the same point in time, both presynaptic cell <span class="math inline">j</span> and postsynaptic cell <span class="math inline">i</span> fire more than the adjusted mean activities of their respective layers. As <span class="math inline">\eta^\text{Ca}</span> is set to the relatively small value of <span class="math inline">\eta^\text{inc}</span> in that case, the corresponding calcium level increases rapidly. In contrast, <span class="math inline">dCa^\text{post}_{i,j}(t)</span> becomes negative when concurrent activity ceases. As <span class="math inline">\eta^\text{Ca}</span> is set to a relatively large value (<span class="math inline">\eta^\text{dec}</span>) in that case, the calcium level does not directly drop to zero but declines rather smoothly. Calcium eligibility traces are inspired by findings that calcium levels stay heightened for some interval longer than actual pre- and postsynaptic activities <span class="citation" data-cites="Koetter1994">(<a href="References.html#ref-Koetter1994" role="doc-biblioref">Kötter, 1994</a>)</span> and that postsynaptic calcium is required for striatal dopamine-mediated learning <span class="citation" data-cites="Cepeda1998 Suzuki2001">(<a href="References.html#ref-Cepeda1998" role="doc-biblioref">Cepeda et al., 1998</a>; <a href="References.html#ref-Suzuki2001" role="doc-biblioref">Suzuki et al., 2001</a>)</span>.</p>
<p>To determine changes in BG-related weights (<span class="math inline">w_{i,j}^\text{pre-post}(t)</span>), a three-factor learning rule is used, comprising the calcium trace described above (which contains the two factors pre- and postsynaptic activity) and a dopaminergic term <span class="math inline">(\text{DA}(t))</span> linked to reward delivery:</p>
<p><span id="eq-nn:w"><span class="math display">
     \eta  \cdot \frac{dw_{i,j}^\text{pre-post}(t)}{dt} = f_\text{DA}(\text{DA}(t)-\text{DA}_\text{base}) \cdot Ca^\text{post}_{i,j}(t) - \alpha_i(t) \cdot (u_i^\text{post}(t) - \overline{\text{post}}(t))^2 \cdot w_{i,j}^\text{pre-post}(t)
\tag{4.5}</span></span></p>
<p><span id="eq-nn:alpha"><span class="math display">
    \tau \cdot \frac{d \alpha_i(t)}{dt} + \alpha_i(t) = K_\alpha  \cdot (u_i^\text{post}(t) - u^\text{MAX})^+
\tag{4.6}</span></span></p>
<p><span id="eq-nn:da"><span class="math display">
    f_\text{DA}(x) = \begin{cases}  x \qquad \text{if } x &gt; 0 \\
                                    \varphi \cdot x \qquad \text{else.} \\
                     \end{cases}
\tag{4.7}</span></span></p>
<p><span class="math inline">\text{DA}(t)</span> is the dopamine level of the respective loop at time <span class="math inline">t</span>, <span class="math inline">\text{DA}_\text{base}</span> the baseline dopamine level of 0.5, <span class="math inline">\alpha_i(t)</span> a regularization factor, <span class="math inline">u^\text{MAX}</span> the maximal desired firing rate of cell i, <span class="math inline">\varphi</span> a constant regulating the strength of long-term depression (LTD) relative to the strength of long-term potentiation (LTP) and <span class="math inline">K_\alpha</span> a constant that determines the speed of increases of <span class="math inline">\alpha_i(t)</span>. In case of a dopamine burst (i.e.&nbsp;when dopamine levels rise above baseline), all weights are increased in proportion to the strengths of their calcium traces; dopamine depletions (i.e.&nbsp;dopamine levels below baseline) decrease recently active synapses accordingly. The subtractive term of the equation ensures that weights do not increase infinitely: when connections are strong enough to push firing of a postsynaptic cell above a threshold defined by <span class="math inline">u^\text{MAX}</span>, <span class="math inline">\alpha_i</span> increases and all weights to that postsynaptic cell are decreased. This ensures homeostatic synaptic plasticity, i.e.&nbsp;it provides negative feedback to level excessive neuronal excitation <span class="citation" data-cites="Pozo2010">(cf. <a href="References.html#ref-Pozo2010" role="doc-biblioref">Pozo and Goda, 2010</a> for a biological review on the phenomenon)</span>. Technically, the homeostatic term is derived from Oja’s rule <span class="citation" data-cites="Oja1982">(<a href="References.html#ref-Oja1982" role="doc-biblioref">Oja, 1982</a>)</span>, but <span class="math inline">\alpha_i</span> is made dependent upon postsynaptic activity to avoid arbitrary parameter values. Biologically, homeostatic synaptic plasticity has been shown to arise from alterations in the composition and abundance of postsynaptic AMPA receptors <span class="citation" data-cites="Pozo2010">(<a href="References.html#ref-Pozo2010" role="doc-biblioref">Pozo and Goda, 2010</a>)</span>. Increases of <span class="math inline">\alpha_i</span> can be fast or slow depending on the value of <span class="math inline">K_\alpha</span>.</p>
<p>By applying a single set of learning principles to all loops, we show their flexibility to subserve two highly different functions, namely to establish flexible control of WM and to link distinct cortical representations in a stimulus-response manner, thereby linking WM to motor control. While the general learning rules for prefrontal and motor loops are the same, the parameter values regulating LTD in the case of dopamine depletion differ. In particular, LTD in prefrontal loops is assumed to be slower than in the motor loop. Functionally, this ensures that after a sudden change in reward contingencies (resulting in dopamine depletions), re-learning in the motor loop is faster than re-learning in prefrontal loops: attempts to map priorly relevant stimuli onto different responses will thus be undertaken faster than gating previously irrelevant stimuli into WM.</p>
<p>The following paragraphs will focus on the different functional parts of the model and more thoroughly explain the supposed architecture.</p>
<section id="cortex" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="cortex">Cortex</h4>
<p>The model contains the cortical structures of lateral prefrontal cortex (lPFC) and MI. lPFC is assumed to take part in WM control <span class="citation" data-cites="Owen1999">(<a href="References.html#ref-Owen1999" role="doc-biblioref">Owen et al., 1999</a>)</span>; MI integrates cortical and subcortical inputs to send an emerging motor command to the motoneurons of the spinal cord. As a simplification, we assume each visual stimulus and motor command to be represented by a single computational unit within cortex. All cortical cells receive excitatory thalamic input; lPFC additionally receives cortico-cortical afferents from ITC which is involved in visual object recognition. In the mammal brain, prefrontal cortex is innervated by dopaminergic fibers. Prefrontal dopamine has been shown to modulate WM processes <span class="citation" data-cites="Seamans2004 Vijayraghavan2007">(<a href="References.html#ref-Seamans2004" role="doc-biblioref">Seamans and Yang, 2004</a>; <a href="References.html#ref-Vijayraghavan2007" role="doc-biblioref">Vijayraghavan et al., 2007</a>)</span>. However, these dopamine signals appear to last for several minutes <span class="citation" data-cites="Feenstra1996 Feenstra2000 vanderMeulen2007 Yoshioka1996">(<a href="References.html#ref-Feenstra2000" role="doc-biblioref">Feenstra et al., 2000</a>; <a href="References.html#ref-Feenstra1996" role="doc-biblioref">Feenstra and Botterblom, 1996</a>; <a href="References.html#ref-vanderMeulen2007" role="doc-biblioref">van der Meulen et al., 2007</a>; <a href="References.html#ref-Yoshioka1996" role="doc-biblioref">Yoshioka et al., 1996</a>)</span> and are therefore not well suited to reinforce particular stimulus-response associations in a timely precise manner. Within the model, learning of thalamo-cortical weights is therefore assumed to be Hebbian-like (i.e.&nbsp;to not be modulated by dopamine). As our model is essentially an account of how learning in BG guides the organization of cortico-BG-thalamic loops, we do not model prefrontal dopamine signals.</p>
</section>
<section id="thalamus" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="thalamus">Thalamus</h4>
<p>Thalamus is assumed to relay information to cortical areas <span class="citation" data-cites="Guillery2002">(<a href="References.html#ref-Guillery2002" role="doc-biblioref">Guillery and Sherman, 2002</a>)</span> and to control cortical activation and deactivation <span class="citation" data-cites="Hirata2010">(<a href="References.html#ref-Hirata2010" role="doc-biblioref">Hirata and Castro-Alamancos, 2010</a>)</span>. Consistent with this, maintenance of a representation in WM and selection of a response require thalamic disinhibition through GPi in the model. Thalamic cells receive inhibitory pallidal and excitatory cortical input (cf. <a href="#fig-nn:fig1" class="quarto-xref">Figure&nbsp;<span>4.1</span></a>). As with prefrontal cortex, there is evidence for dopaminergic innervation of the thalamus <span class="citation" data-cites="Melchitzky2001 Sanchez-Gonzalez2005">(<a href="References.html#ref-Melchitzky2001" role="doc-biblioref">Melchitzky and Lewis, 2001</a>; <a href="References.html#ref-Sanchez-Gonzalez2005" role="doc-biblioref">Sánchez-González et al., 2005</a>)</span>. The nature of the dopamine signals provided, however, has not yet been clearly elucidated. Conservatively, we thus assume cortico-thalamic learning to be Hebbian-like (i.e.&nbsp;not to be modulated by dopamine).</p>
</section>
<section id="striatum" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="striatum">Striatum</h4>
<p>There are two input structures to the BG: striatum and STN. Both receive glutamatergic cortical afferents and both are organized topographically <span class="citation" data-cites="Ebrahimi1992 Miyachi2006">(<a href="References.html#ref-Ebrahimi1992" role="doc-biblioref">Ebrahimi et al., 1992</a>; <a href="References.html#ref-Miyachi2006" role="doc-biblioref">Miyachi et al., 2006</a>)</span>. Striatum can be subdivided into putamen, receiving mostly motor-cortical afferents, and caudate nucleus, innervated by lPFC <span class="citation" data-cites="Alexander1986">(<a href="References.html#ref-Alexander1986" role="doc-biblioref">Alexander et al., 1986</a>)</span>. Next to excitatory cortical afferents, striatal cells receive inhibitory input from a network of GABAergic interneurons <span class="citation" data-cites="Suzuki2001">(<a href="References.html#ref-Suzuki2001" role="doc-biblioref">Suzuki et al., 2001</a>)</span>. In the model, these are hard-coded for means of simplicity and serve to downsize the number of striatal cells that become associated to each cortical representation. Activity of caudate nucleus has been shown to be negatively correlated with progress in reward-related learning <span class="citation" data-cites="Delgado2005">(<a href="References.html#ref-Delgado2005" role="doc-biblioref">Delgado et al., 2005</a>)</span>. Lesioning dorsolateral parts of the striatum leads to disabilities in stimulus-response learning <span class="citation" data-cites="Featherstone2004">(<a href="References.html#ref-Featherstone2004" role="doc-biblioref">Featherstone and McDonald, 2004</a>)</span>. Within the model, striatum learns to efficiently represent single or converging cortical afferents in clusters of simultaneously activated cells as previously shown by <span class="citation" data-cites="Vitay2010">Vitay and Hamker (<a href="References.html#ref-Vitay2010" role="doc-biblioref">2010</a>)</span>. Striatum gives rise to the direct BG pathway, that connects striatal cell clusters to single GPi cells. Thereby, it is vital both for WM maintenance and stimulus-response mapping.</p>
</section>
<section id="subthalamic-nucleus" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="subthalamic-nucleus">Subthalamic nucleus</h4>
<p>STN is considered part of the hyperdirect BG pathway that links cortex with GPi via two excitatory connections <span class="citation" data-cites="Nambu2002">(<a href="References.html#ref-Nambu2002" role="doc-biblioref">Nambu et al., 2002</a>)</span>. Also, STN excitatorily innervates GPe <span class="citation" data-cites="Parent1995">(<a href="References.html#ref-Parent1995" role="doc-biblioref">Parent and Hazrati, 1995</a>)</span>. Recently, STN has become a key target for deep brain stimulation (DBS) in Parkinsonian patients in order to alleviate dyskinesia <span class="citation" data-cites="Kleiner-Fisman2006">(<a href="References.html#ref-Kleiner-Fisman2006" role="doc-biblioref">Kleiner-Fisman et al., 2006</a>)</span> and to improve mental flexibility <span class="citation" data-cites="Alegret2001 Witt2004">(<a href="References.html#ref-Alegret2001" role="doc-biblioref">Alegret et al., 2001</a>; <a href="References.html#ref-Witt2004" role="doc-biblioref">Witt et al., 2004</a>)</span>. STN DBS has been reported to cause WM deficits in spatial delayed response tasks <span class="citation" data-cites="Hershey2008">(<a href="References.html#ref-Hershey2008" role="doc-biblioref">Hershey et al., 2008</a>)</span> and nn-back tasks <span class="citation" data-cites="Alberts2008">(<a href="References.html#ref-Alberts2008" role="doc-biblioref">Alberts et al., 2008</a>)</span>, thereby further underlining its contribution to cognitive processing. Electrical stimulation of STN in monkeys yields a short-latency, short-duration excitation of GPi, followed by a strong inhibition, the latter being mediated by GPe <span class="citation" data-cites="Kita2005">(<a href="References.html#ref-Kita2005" role="doc-biblioref">Kita et al., 2005</a>)</span>. Based on these findings, we assume STN within prefrontal loops to give a global (learned) excitatory reset signal to GPi that is canceled by STN-GPe-GPi fibers shortly after.</p>
</section>
<section id="globus-pallidus-external-segment" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="globus-pallidus-external-segment">Globus pallidus external segment</h4>
<p>The role of GPe in BG functioning is still rather elusive. Historically, GPe has been considered a relay station on a striato-GPe-subthalamo-GPi pathway, often referred to as the indirect BG pathway <span class="citation" data-cites="DeLong1990">(<a href="References.html#ref-DeLong1990" role="doc-biblioref">DeLong, 1990</a>)</span>. More recently, such a simple notion has been challenged and GPe has been hypothesized to have a more prominent processing function in BG <span class="citation" data-cites="Obeso2006">(<a href="References.html#ref-Obeso2006" role="doc-biblioref">Obeso et al., 2006</a>)</span>. Our model contains a reduced set of GPe connections, accounting for afferents from STN and efferents to GPi only. Thereby, GPe is modeled only in its potential contribution to the hyperdirect (and not the indirect) pathway.</p>
</section>
<section id="globus-pallidus-internal-segment" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="globus-pallidus-internal-segment">Globus pallidus internal segment</h4>
<p>The internal segment of globus pallidus is a major BG output structure receiving and integrating subthalamic, external pallidal and striatal input <span class="citation" data-cites="DeLong2007">(<a href="References.html#ref-DeLong2007" role="doc-biblioref">DeLong and Wichmann, 2007</a>)</span>. GPi has a high baseline firing rate by which it tonically inhibits thalamic neurons <span class="citation" data-cites="Chevalier1990">(<a href="References.html#ref-Chevalier1990" role="doc-biblioref">Chevalier and Deniau, 1990</a>)</span>. Striatal and GPe inputs inhibit GPi cells below this baseline, thus disinhibiting thalamic neurons and opening a gate for mutually excitatory cortico-thalamic loops <span class="citation" data-cites="DeLong2007">(<a href="References.html#ref-DeLong2007" role="doc-biblioref">DeLong and Wichmann, 2007</a>)</span>. Subthalamic input in contrast excites GPi, thus further inhibiting thalamic neurons and preventing cortico-thalamic loops from firing <span class="citation" data-cites="Nambu2002">(<a href="References.html#ref-Nambu2002" role="doc-biblioref">Nambu et al., 2002</a>)</span>. The interplay of afferents to GPi which is critical for the model’s functioning, will be studied in detail in <a href="#sec-nn:analysis" class="quarto-xref"><span>Section 4.3.2</span></a> of this paper.</p>
<p>Lateral competition in GPi ensures that each striatal cell cluster connects to a single pallidal cell only. While this is of course a simplification, it reasonably reflects the much smaller number of pallidal cells relative to striatal ones <span class="citation" data-cites="Lange1976">(<a href="References.html#ref-Lange1976" role="doc-biblioref">Lange et al., 1976</a>)</span>. As shown in Eq. (A.23) of the Appendix A, lateral weights evolve according to an Anti-Hebbian learning rule.</p>
</section>
<section id="substantia-nigra-pars-compacta" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="substantia-nigra-pars-compacta">Substantia nigra pars compacta</h4>
<p>Inspired by the findings of Schultz and co-workers <span class="citation" data-cites="Hollerman1998 Schultz1997">(<a href="References.html#ref-Hollerman1998" role="doc-biblioref">Hollerman and Schultz, 1998</a>; <a href="References.html#ref-Schultz1997" role="doc-biblioref">Schultz et al., 1997</a>)</span> and in line with other computational accounts of reinforcement learning <span class="citation" data-cites="Brown1999">O’Reilly and Frank (<a href="References.html#ref-OReilly2006" role="doc-biblioref">2006</a>)</span>, we assume SNc neurons to compute an error signal of reward prediction. This signal is then relayed to BG to modulate learning of afferent connections. A detailed account of the underlying rationale can be found in <span class="citation" data-cites="Vitay2010">Vitay and Hamker (<a href="References.html#ref-Vitay2010" role="doc-biblioref">2010</a>)</span>. Briefly, SNc neurons compute a difference signal between actual and expected rewards and add the resulting value to a medium baseline firing rate of 0.5. Thereby, unexpected rewards lead to activities above this baseline while omissions of expected rewards result in decreases in SNc firing. Information about actual rewards is set as an external input while stimulus-specific reward expectations are encoded in learnable striato-nigral afferents.</p>
<p>Each prefrontal and motor loop is connected to a separate SNc neuron. This is based upon reports showing SNc to have a topographical organization and reciprocal connections with striatum <span class="citation" data-cites="Haber2003 Joel2000">(<a href="References.html#ref-Haber2003" role="doc-biblioref">Haber, 2003</a>; <a href="References.html#ref-Joel2000" role="doc-biblioref">Joel and Weiner, 2000</a>)</span>. Inspired by evidence showing SNc neurons to broadly innervate striatal subregions <span class="citation" data-cites="Matsuda2009">(<a href="References.html#ref-Matsuda2009" role="doc-biblioref">Matsuda et al., 2009</a>)</span>, we assume a single dopamine neuron to innervate all BG cells of a corresponding loop.</p>
</section>
<section id="pedunculopontine-nucleus" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="pedunculopontine-nucleus">Pedunculopontine nucleus</h4>
<p>As outlined above, the model contains multiple prefrontal loops. Following an idea by <span class="citation" data-cites="Krueger2009">Krueger and Dayan (<a href="References.html#ref-Krueger2009" role="doc-biblioref">2009</a>)</span>, recruitment of these loops is dependent upon error detection after prior successful task performance. The framework of our model allows us to develop a biologically plausible mechanism of error detection: highly unexpected errors (i.e.&nbsp;errors after prior successful task performance) lead to relatively large dips in SNc firing. These dips can be used as a signal to recruit additional SNc neurons, thereby enabling learning within additional prefrontal loops.</p>
<p>A potential anatomic substrate for subserving such a recruitment is a part of the brainstem named pedunculopontine nucleus (PPN). PPN has been associated to the phenomena of attention, arousal, reward-based learning and locomotion <span class="citation" data-cites="Winn2006">(<a href="References.html#ref-Winn2006" role="doc-biblioref">Winn, 2006</a>)</span>; activation of cholinergic fibers from PPN to SNc has been shown to recruit quiescent dopamine neurons <span class="citation" data-cites="DiGiovanni2009">(<a href="References.html#ref-DiGiovanni2009" role="doc-biblioref">Di Giovanni and Shi, 2009</a>)</span>. As PPN is innervated by many BG structures <span class="citation" data-cites="Mena-Segovia2004">(<a href="References.html#ref-Mena-Segovia2004" role="doc-biblioref">Mena-Segovia et al., 2004</a>)</span>, it presumably also receives information about reward prediction. In our model, PPN constantly receives input from the SNc. Whenever the most recently recruited prefrontal-loop SNc neuron fires below a fixed threshold of 0.05 because of a highly unexpected error, PPN sends an activation signal back to the SNc to recruit an additional SNc neuron. Through this simple operation, PPN subserves a basic form of task monitoring, reacting whenever unexpected omissions of reward occur. In employing this mechanism, we do not artificially decrease learning rates within those prefrontal loops that previously recruited SNc neurons belong to. This contrasts with the model of <span class="citation" data-cites="Krueger2009">Krueger and Dayan (<a href="References.html#ref-Krueger2009" role="doc-biblioref">2009</a>)</span>.</p>
<p>Of course, the mechanism we propose may be largely simplified: other brain areas than the PPN have been linked to error detection as well, in particular the anterior cingulate <span class="citation" data-cites="Holroyd2002">(<a href="References.html#ref-Holroyd2002" role="doc-biblioref">Holroyd and Coles, 2002</a>)</span>. Further, PPN output is not restricted to SNc but also reaches other BG nuclei, most notably STN <span class="citation" data-cites="Winn2006">(<a href="References.html#ref-Winn2006" role="doc-biblioref">Winn, 2006</a>)</span>. Thus, PPN will neither be the only brain structure involved in error detection nor will recruitment of dopamine neurons be the only way it assists in modulating learning in cortico-BG-thalamic loops.</p>
</section>
</section>
<section id="sec-nn:setup" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="sec-nn:setup"><span class="header-section-number">4.2.2</span> Experimental setups</h3>
<p>We demonstrate the model’s learning capabilities on DR tasks as well as on the 1-2-AX conditional WM task.</p>
<section id="delayed-response-and-delayed-alternation-tasks" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="delayed-response-and-delayed-alternation-tasks">Delayed response and delayed alternation tasks</h4>
<p>We trained the model on an unconditional DR task, a conditional DR task and a DA task. In all three tasks, the model is exposed to a continuous array of trials. Within each trial, it has to choose between two responses and is rewarded if it picks the correct one. When a network has performed correctly for 100 trials in a row, we assume it to have learned the task successfully. A failure is admitted if a network does not reach this criterion within 10,000 trials.</p>
<p>In the unconditional DR task (cf. <a href="#fig-nn:fig2" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> (A)), one of two stimuli (i.e.&nbsp;either stimulus A or stimulus B) is presented for 400 ms at the beginning of each trial. After a delay period of 200 ms, the model’s response is evaluated. For stimulus A, the left button has to be selected while stimulus B requires a right-button press. The model has no prior knowledge about associations between stimuli and buttons. The conditional DR task (cf. <a href="#fig-nn:fig2" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> (B)) differs from the unconditional DR task in that two stimuli are displayed and that both of them have to be considered to achieve a correct response: if stimuli A and X (or B and Y) have been shown, a left-button press is required while presentation of stimuli A and Y (or B and X) requires a right-button press. In the DA task (cf. <a href="#fig-nn:fig2" class="quarto-xref">Figure&nbsp;<span>4.2</span></a> (C)), the model is supposed to alternate between left- and right-button presses every 1200 ms. Reward is given whenever it chooses the button that it did not choose in the previous trial. For the DA task, we make the additional assumption that the model visually perceives the response that it decides for. Each response is thus fed into the model as a stimulus.</p>
<div id="fig-nn:fig2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig2.png" class="img-fluid figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.2: Delayed response tasks and delayed alternation task: In each task, the model is confronted with a successive array of trials. Within each trial, it has to choose between a left- and a right-button press. Circles indicate correct responses. Depending on the task, stimuli may or may not be presented. Detailed explanations are given in the main text. (A) Unconditional DR task. (B) Conditional DR task. (C) DA task. DR: delayed response; DA: delayed alternation; le: left button; ri: right button.
</figcaption>
</figure>
</div>
</section>
<section id="ax-task" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ax-task">1-2-AX task</h4>
<p>Within each trial of this task, one of a set of eight possible stimuli (1, 2, A, B, C, X, Y and Z) is shown and the model is required to decide for one of two buttons (cf. <a href="#fig-nn:fig3" class="quarto-xref">Figure&nbsp;<span>4.3</span></a>). Only and exactly one of these buttons will lead to reward when pressed. The task has a complex inner-outer loop structure that is not known to the model: numbers (1 and 2) represent context cues and constitute the outer loop. To correctly perform the task, the last outer-loop stimulus has to be kept in WM at any time. Whenever the last outer-loop stimulus has been a 1, presentation of an X requires a right-button press when it has been directly preceded by an A; if the last outer-loop stimulus has been a 2, a Y that directly follows a B requires a right-button response. In all other cases, a left-button press has to be performed. The model has to decide for a response within each trial. There are several versions of this task regarding the sequence of stimuli. We will here use the version employed by <span class="citation" data-cites="OReilly2006">O’Reilly and Frank (<a href="References.html#ref-OReilly2006" role="doc-biblioref">2006</a>)</span>: First, an outer-loop stimulus (i.e.&nbsp;1 or 2) is randomly chosen. Then, with equal probabilities, one to four inner loops are generated. With a probability of 0.5, an inner loop consists of a potential target sequence (i.e.&nbsp;A-X or B-Y); otherwise, any of the inner-loop stimuli (i.e.&nbsp;A,B or C) is followed by any of X,Y or Z, all probabilities being equal.</p>
<div id="fig-nn:fig3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig3.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.3: The 1-2-AX conditional WM task and the shaping procedure proposed to train the model. In each trial, a stimulus is presented and the model has to choose between a left- and a right-button press. Circles indicate correct responses. Please refer to the main text for detailed explanations. (A) Full 1-2-AX task. (B) Step 1 of the shaping procedure involving only the outer-loop stimuli 1 and 2. (C) Step 2 of the shaping procedure involving outer-loop stimuli (1 and 2) plus inner-loop stimuli (A,B and C). le: left button; ri: right button.
</figcaption>
</figure>
</div>
<p>Teaching this task to the model requires a three-step shaping procedure as depicted in <a href="#fig-nn:fig3" class="quarto-xref">Figure&nbsp;<span>4.3</span></a>. In a first step, only the outer-loop stimuli 1 and 2 are presented, probabilities being equal. Each 1 requires a right-button press, each 2 a left-button press. When the model has reliably acquired this task (which is conservatively assumed to be the case after 100 correct responses in a row), the inner-loop stimuli A,B and C are added to the sequence. An outer-loop stimulus can be followed by one or two inner-loop stimuli, all probabilities again being equal. A right-button press is required when an A comes up and the last number has been a 1 and when a B comes up and the last number has been a 2. In all other cases, a left-button press is required. Finally, when the second step is securely coped with, the full task is presented. After 150 correct responses in a row, the model is classified as having solved the task; if this criterion is not reached within 10,000 trials, we admit that the model has failed. In the first two steps of shaping, stimulus presentation (lasting for 400 ms) is separated from response requirement by a 400 ms delay period. This is to ensure that the model learns to make use of WM, preventing it from solving the task by simply associating visual ITC representations to responses. By employing the latter strategy, the model would not develop the ability to maintain the stimuli in WM as is required to successfully master the subsequent steps of shaping. For the full task, responses are required while visual stimulation is still on as proposed by <span class="citation" data-cites="OReilly2006">O’Reilly and Frank (<a href="References.html#ref-OReilly2006" role="doc-biblioref">2006</a>)</span>. Each stimulus is presented for 800 ms. 400 ms after each stimulus onset, the model’s response is evaluated.</p>
</section>
</section>
</section>
<section id="results" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="results"><span class="header-section-number">4.3</span> Results</h2>
<section id="task-performance" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="task-performance"><span class="header-section-number">4.3.1</span> Task performance</h3>
<section id="delayed-response-and-delayed-alternation-tasks-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="delayed-response-and-delayed-alternation-tasks-1">Delayed response and delayed alternation tasks</h4>
<p>Fig. <a href="#fig-nn:fig4" class="quarto-xref">Figure&nbsp;<span>4.4</span></a> (A) shows the model’s performance in learning the DR/DA tasks. For each of the three versions of the task, 50 randomly initialized networks were run. For each task, box plots show the number of trials needed until the last error occurs.</p>
<div id="fig-nn:fig4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig4.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.4: The model’s performance in learning several WM tasks. (A) Performance on the DR/DA tasks. (B) Performance on the 1-2-AX task, separately for each step of shaping. (C) Performance on the generalization test described in <a href="#sec-nn:analysis" class="quarto-xref"><span>Section 4.3.2</span></a>. For each of the tasks, 50 randomly initialized networks were run. Box plots show the number of trials needed until the last error occurs. The boxes’ upper and lower borders represent upper and lower quartiles, respectively; the median value is shown as a line crossing each box. Whiskers extend to a maximal length of 1.5 times interquartile range, outliers are represented by asterisks.
</figcaption>
</figure>
</div>
<p>One network failed to learn to criterion. Two-sided Mood’s median tests provide difference statistics for the number of trials needed until the last error occurs. Thanks to the stability of these non-parametric tests in the presence of outliers, we kept the failing network for statistical analyses, charging the maximum number of 10,000 trials: the unconditional DR task (Mdn=111, IQR=33) requires significantly less trials than the conditional DR task (Mdn=443.5, IQR=221), <span class="math inline">\chi^2(1)</span> = 92.16, p &lt; 0.001. Clearly, this is because of its simpler rules. The DA task (Mdn=70.5, IQR=22) takes significantly less trials than both the unconditional DR task, <span class="math inline">\chi^2(1)</span> = 51.84, p &lt; 0.001, and the conditional DR task, <span class="math inline">\chi^2(1)</span> = 84.64, p &lt; 0.001.</p>
</section>
<section id="ax-task-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ax-task-1">1-2-AX task</h4>
<p><a href="#fig-nn:fig4" class="quarto-xref">Figure&nbsp;<span>4.4</span></a> (B) shows the performance of 50 randomly initialized networks learning the 1-2-AX task. For each step of the shaping procedure, box plots show the number of trials needed until the last error occurs.</p>
<p>All networks learned the task to criterion. Two-sided Wilcoxon signed-rank tests provide difference statistics for the number of trials needed to cope with the different steps: the second step of shaping (Mdn=365, IQR=78) takes significantly longer than the first step (Mdn=130, IQR=23), z=6.15, p&lt;0.001, as can be explained by the more complex set of rules to learn and the higher number of additional WM representations to develop. The third step (Mdn=352.5, IQR=402) requires significantly more trials than the first step, z=5.49, p&lt;0.001, but does not differ significantly from the second step, z=0.50, p=0.62. In the third step, a highly complex set of rules has to be learned while no additional WM representations have to be developed.</p>
</section>
</section>
<section id="sec-nn:analysis" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="sec-nn:analysis"><span class="header-section-number">4.3.2</span> Analysis of the model’s behavior</h3>
<section id="re-learning-and-generalization" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="re-learning-and-generalization">Re-learning and generalization</h4>
<p>To demonstrate the model’s abilities to profit from previous experiences, we evaluated its performance both in re-learning a task that has previously been learned and in generalizing from previous experiences to a new but structurally similar task. To this end, we trained 100 randomly initialized networks on the first two steps of the shaping procedure designed for the 1-2-AX task. Once the second step was learned to criterion, we again changed the rules: for 50 networks, we went back to the first step of shaping to evaluate re-learning. Note that learning the second step could have overwritten the knowledge acquired in the first step. For the 50 remaining networks, we changed the meanings of the two outer-loop stimuli to evaluate generalization. Previously, a right-button press had been required for an AA if the most recent number had been a 1 and for a BB if it had been a 2. Now it was required for an AA when the last number had been a 2 and for a BB when it had been a 1. Note that in this test for generalization the stimuli stay the same while responses have to be adapted.</p>
<p><a href="#fig-nn:fig4" class="quarto-xref">Figure&nbsp;<span>4.4</span></a> (C) shows the model’s performance on these tests of re-learning and generalization. All networks learned to criterion. Difference statistics are based on two-sided Wilcoxon signed-rank tests. Re-learning the first step of shaping (Mdn=7.5, IQR=7) is significantly faster than the initial process of learning it (Mdn=129, IQR=25), z=6.15, p&lt;0.001. Learning the generalization task (Mdn=19.5,IQR=11) takes significantly less trials than learning the first plus the second step of shaping (Mdn=493.5, IQR=112), z=6.15, p&lt;0.001. Thus, the generalization task is learned a lot faster than the equally complex task that is learned during the first two steps of shaping. In fact, the generalization task is even learned significantly faster than both the first step of shaping by itself (Mdn=127.5, IQR=35), z=6.14, p&lt;0.001, and than the second step of shaping by itself (Mdn=360.5, IQR=88), z=6.15, p&lt;0.001. Thereby, it is clearly shown that the model profits from previous experiences: the more it has already learned about its environment, the better become its abilities to solve further problems.</p>
</section>
<section id="spread-of-activity-within-cortico-bg-thalamic-loops" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="spread-of-activity-within-cortico-bg-thalamic-loops">Spread of activity within cortico-BG-thalamic loops</h4>
<p>When a stimulus is presented to the model, it can either become maintained in WM or it fades away as visual stimulation ends. <a href="#fig-nn:fig5" class="quarto-xref">Figure&nbsp;<span>4.5</span></a> illustrates how a target stimulus-once associated to reward-is actively maintained in WM: when the target comes up in ITC, target-related activity (black line) is relayed to lPFC. lPFC then activates associated striatal and subthalamic cells. Subthalamic activity rises fast leading to a global increase in GPi firing via all-to-all excitatory connections. This breaks the circle of reverberating activity in the respective prefrontal loop, erasing any previously maintained stimulus (see gray lines) from WM. In the meantime, GPe activity rises through subthalamic excitation. By all-to-all inhibitory connections to GPi, GPe counterbalances the excitatory effect of STN on GPi and thereby-with a brief delay-brings WM reset to an end. As the previously maintained stimulus is erased from WM, target-related lPFC activity can activate striatal target-coding cells. Via inhibitory connections, these striatal cells then decrease firing of a GPi neuron that is associated to the target. This neuron in turn disinhibits a corresponding thalamic cell. Thalamus then excites cortex so that target-associated activity can reverberate in the prefrontal loop.</p>
<p><a href="#fig-nn:fig6" class="quarto-xref">Figure&nbsp;<span>4.6</span></a> depicts the effects of target presentation on the motor loop: the target-coding cells within lPFC and ITC excite striatal cells of the motor loop. These cells then inhibit an associated GPi cell that in turn disinhibits a corresponding thalamic cell. Thalamus then excites the particular MI cell that codes the response that the target stimulus has been mapped on.</p>
<div id="fig-nn:fig5" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig5.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.5: Prefrontal-loop effects of presenting a task-relevant stimulus (target) to the model when another stimulus is currently kept in working memory. For various layers of a prefrontal loop, subplots present firing rates of selected cells within a 500 ms time period covering target presentation onset (denoted by arrows). Firing rates of cells coding the target are shown as black lines while gray lines correspond to the previously maintained stimulus. All firing rates are taken from a randomly initialized network successfully coping with an unconditional DR task. Explanations are given in the main text. GPe: globus pallidus external segment; GPi: globus pallidus internal segment; ITC: inferior temporal cortex; lPFC: lateral prefrontal cortex; STN: subthalamic nucleus; Str: Striatum; Thal: thalamus.
</figcaption>
</figure>
</div>
<div id="fig-nn:fig6" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig6.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.6: Motor-loop effects of presenting a task-relevant stimulus (target) to the model when another stimulus is currently kept in working memory. For various layers of the motor loop, subplots present firing rates of selected cells within a 500 ms time period covering target presentation onset (denoted by arrows). Firing rates of cells associated to the target and its associated response are shown as black lines, gray lines correspond to the previously maintained stimulus and its associated response. All firing rates are taken from a randomly initialized network successfully coping with an unconditional delayed response task. Explanations are given in the main text. GPi: globus pallidus internal segment; ITC: inferior temporal cortex; lPFC: lateral prefrontal cortex; MI: primary motor cortex; Str: Striatum; Thal: thalamus.
</figcaption>
</figure>
</div>
</section>
<section id="development-of-wm-control" class="level4" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="development-of-wm-control"><span class="header-section-number">4.3.2.1</span> Development of WM control</h4>
<p><a href="#fig-nn:fig7" class="quarto-xref">Figure&nbsp;<span>4.7</span></a> shows the development of WM control. Firing rates are taken from a randomly initialized network learning the unconditional DR task. Infero-temporal, lateral prefrontal, striatal, subthalamic and pallidal activities of the prefrontal loop are shown for four periods along the process of learning (trials 1-5, 52-56, 91-95 and 129-133). The unconditional DR task we employed contains two stimuli, AA and BB. Black lines show firing rates of cells that can a posteriori be identified as having learned to code stimulus AA, gray lines correspond to stimulus BB.</p>
<div id="fig-nn:fig7" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig7.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.7: Development of WM control in the prefrontal loop that is directly subject to learning during an unconditional delayed response task. Subplots show firing rates of various prefrontal-loop layers for 5000 ms periods at different stages of the learning process (trials 1-5, 52-56, 91-95 and 129-133). Black lines depict firing rates of cells coding stimulus AA while gray lines correspond to stimulus (BB). Explanations are given in the main text. GPi: globus pallidus internal segment; ITC: inferior temporal cortex; lPFC: lateral prefrontal cortex; STN: subthalamic nucleus; Str: striatum.
</figcaption>
</figure>
</div>
<p>The leftmost column (trials 1-5) shows prefrontal-loop activities soon after the model is exposed to the task: lPFC task-related activities begin to emerge through the development of Hebbian connections from ITC. The corresponding lPFC cells have, however, not yet learned to activate striatal or subthalamic cells so that all representations fade away from WM when visual stimulation ends. Some decades of trials later (trials 52-56), cortico-subthalamic connections have largely developed as evidenced by the existence of task-related subthalamic activity upon stimulus presentation. Further, cortico-striatal connections have begun to emerge, resulting in some striatal activity upon stimulus presentation. Pallidal representations have not yet clearly developed as evidenced by the more or less uniform firing of GPi across trials. Thus, stimulus-associated activity cannot reverberate within cortico-BG-thalamic loops and lPFC representations still fade away when visual stimulation ends. Another four decades of trials later (trials 91-95), pallidal representations have started to evolve: stimulus BB (gray lines) shows clear task-related GPi activity (i.e.&nbsp;decreases of firing rates contingent upon stimulus presentation). This stimulus is now maintained in the loop independent of visual stimulation (which can be seen by ongoing activity after visual input ends). It can be concluded that a closed loop of connections that subserve the observed maintenance has been developed for this stimulus. Stimulus AA (black lines) however is still not clearly represented in the layers and mostly fades away when visual input ceases. The rightmost column shows the network when it has fully learned the DR task (trials 129-133): all brain areas show clear task-related activities. Both stimuli are maintained throughout the delay periods. Notice that when a stimulus is presented twice in a row, WM is not reset in between.</p>
</section>
<section id="recruitment-of-prefrontal-loops" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="recruitment-of-prefrontal-loops">Recruitment of prefrontal loops</h4>
<p>As outlined in <a href="#sec-nn:architecture" class="quarto-xref"><span>Section 4.2.1</span></a>, in cases of unexpected changes of reward contingencies, PPN triggers the activation of quiescent SNc neurons through dips in dopamine levels. This behavior can be well observed in networks learning the 1-2-AX task (<a href="#fig-nn:fig8" class="quarto-xref">Figure&nbsp;<span>4.8</span></a>).</p>
<div id="fig-nn:fig8" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig8.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.8: Activity of SNc neurons over the course of trials, taken from a randomly initialized network learning the 1-2-AX task. Subplots show firing rates for each of the three SNc neurons involved in the task. Arrows indicate where a switch of rules takes place. Explanations are given in the main text. SNc motor: substantia nigra pars compacta (SNc) cell of the motor loop; SNc prefrontal I: SNc cell of the prefrontal loop that is directly subject to dopaminergic modulation; SNc prefrontal II: SNc cell of the prefrontal loop that becomes modulated by dopamine when activated by the pedunculopontine nucleus.
</figcaption>
</figure>
</div>
<p>In the first step of shaping, two SNc neurons are active: the one neuron associated to the motor loop and one of the two neurons associated to prefrontal loops; the third SNc neuron is fixed to the baseline firing rate of 0.5 and awaits its activation by PPN. As the model learns the first step of shaping and becomes successful in predicting reward, firing rates of all active SNc neurons asymptotically approach baseline level (which can be seen around trial 200). As soon as the model has performed correctly for 100 trials in a row, the second step of shaping begins. Thereby, the rules of the task switch and the model cannot predict rewards accurately anymore. As it, however, still expects to be able to, SNc firing rates dip much below baseline. This activates the SNc neuron of the second prefrontal loop (as can be seen around trial 260). Around trial 700, the model has learned to cope with the second step of shaping and dopamine levels approach baseline again. After 100 correct responses in a row, the rules of the task switch again and SNc firing dips. This would now activate an SNc neuron of a third prefrontal loop (which, however, we did not include to save computational time as the tasks presented can be learned without it).</p>
</section>
<section id="how-shaping-helps" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="how-shaping-helps">How shaping helps</h4>
<p>To support the model in learning the 1-2-AX task, we train it using a three-step shaping protocol as described in <a href="#sec-nn:setup" class="quarto-xref"><span>Section 4.2.2</span></a>. This protocol breaks down the inner-outer-loop structure of the task to assist the model in learning it. <a href="#fig-nn:fig9" class="quarto-xref">Figure&nbsp;<span>4.9</span></a> shows mean cortical activities for a network that successfully copes with the full 1-2-AX task. Firing rates of cells that belong to ITC and both parts of lPFC are each averaged over 100 consecutive trials.</p>
<div id="fig-nn:fig9" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nn:fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/nn/fig9.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nn:fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4.9: WM control strategies of prefrontal cortex. For a network that successfully copes with the 1-2-AX task, subplots show mean activities within inferior temporal cortex and both parts of lateral prefrontal cortex: For each cortical cell, mean firing rates are depicted as averaged over 100 trials. ITC: inferior temporal cortex; lPFC I: part of lateral prefrontal cortex that belongs to the prefrontal loop that is directly subject to dopaminergic modulation; lPFC II: part of lateral prefrontal cortex that belongs to the loop that becomes modulated by dopamine when activated by the pedunculopontine nucleus.
</figcaption>
</figure>
</div>
<p>As described in <a href="#sec-nn:architecture" class="quarto-xref"><span>Section 4.2.1</span></a>, visual input is directly fed into ITC. Obviously therefore, ITC shows above-zero activities for all of the task’s stimuli. The different mean firing rates reflect the stimuli’s different probabilities of appearance as defined by the task. In particular, stimuli A,B,XA,B,X and YY are presented most often. lPFC activities are shown separately for the two prefrontal loops. Within the prefrontal loop which is subject to dopaminergic modulation directly, lPFC shows non-zero activities for stimuli 1 and 2. This indicates that this loop alternates between maintenance of the two outer-loop stimuli, ignoring all other stimuli. It thereby follows precisely the strategy of WM control that it has learned during the first step of shaping. The part of lPFC that belongs to the prefrontal loop which is recruited by PPN later shows strong activities for stimuli 1, 2, A,BA,B and CC. Clearly, these are the stimuli presented during the second step of shaping. This loop thereby maintains the last inner-loop stimulus that has been presented. From a global viewpoint, the model therefore maintains both the last outer-loop stimulus and the last inner-loop stimulus in WM at all times. In addition, ITC represents the stimulus presently shown. Via connections from ITC and lPFC to putamen, the motor loop is thus equipped with all the necessary information to choose its responses correctly: it receives information about the last outer-loop stimulus, the last inner-loop stimulus and the currently presented stimulus.</p>
</section>
</section>
</section>
<section id="sec-nn:discussion" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-nn:discussion"><span class="header-section-number">4.4</span> Discussion</h2>
<p>We have shown how interactions among hierarchically interconnected cortico-BG-thalamic loops allow for flexible control of WM and for adaptive stimulus-response mappings. We thereby find that the anatomically well-defined cortico-BG-thalamic architecture is flexible enough to subserve both WM control and response selection. This implies that the same BG nuclei and pathways can subserve different functions on different levels of the system’s hierarchy. The striatum and its associated direct pathway allows for WM maintenance in prefrontal loops and for stimulus-response associations in motor loops. Within the cortico-BG-thalamic architecture, we show how complex strategies of WM control and response selection can be learned by methods of successive approximations and that these methods allow to generalize previously learned behaviors to new situations.</p>
<section id="the-need-for-shaping-in-complex-wm-tasks" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="the-need-for-shaping-in-complex-wm-tasks">The need for shaping in complex WM tasks</h4>
<p>As outlined above, the model relies on a three-step shaping procedure to solve the 1-2-AX task. To understand why shaping is vital to solve a complex task like that, it is necessary to understand its structure: in the 1-2-AX task, different stimuli have to be maintained in WM for differing periods of time. Moreover, they have to be updated independently depending on WM content and visual input. Specifically, outer-loop stimuli have to be deleted from WM only when the next outer-loop stimulus appears, while inner-loop stimuli have to be maintained for one trial only; all other stimuli should not be maintained at all. To make the task even more difficult, the model further has to learn how to correctly respond based on WM content. Decisions about rewards are based upon the final response only, not upon WM control. This poses the need of inferring both correct WM control and response behavior from a binary and thus relatively unspecific reward signal. One way to enable an agent to find out complex strategies of WM control and response behavior is to have it randomly permute the space of potential solutions (i.e.&nbsp;to try out each possible configuration of WM content and responses). <span class="citation" data-cites="OReilly2006">O’Reilly and Frank (<a href="References.html#ref-OReilly2006" role="doc-biblioref">2006</a>)</span> employ such an approach. In their model, the maintenance of representations in WM is not subject to learning, only the gating of stimuli into WM. In order to learn correct WM control and stimulus-response associations, these stimuli must first be gated into WM, otherwise their information is lost before anything can be learned. To get the learning going, their model randomly gates stimuli into WM in an early phase of learning. Sooner or later, this will lead to finding the correct solution. However, such an approach is quite a computational effort and soon becomes practically infeasible as the number of potential stimuli and reactions increases. This is reflected in the much higher number of trials the PBWM model requires to learn the 1-2-AX task (being in the order of 30,000 compared to approximately 1000-1500 for our model, taking our definition of a trial). In contrast, our model allows each stimulus to enter lPFC and then learns WM maintenance and stimulus-response associations via calcium trace learning. As a consequence of this approach, our model does not learn the 1-2-AX task without a shaping procedure. While this might appear as a disadvantage at first sight, we consider it to be advantageous in terms of biological plausibility and flexibility: a human subject who is supposed to learn the 1-2-AX task without being told about its rules (and who has to find them find out through trial and error) will have a pretty hard time. Infant humans who cannot access a similarly broad range of previous experiences surely will not learn it without a shaping procedure. At the beginning of learning, our model does not have any knowledge, either (making infant learning a fair comparison). However, as outlined by <span class="citation" data-cites="Krueger2009">Krueger and Dayan (<a href="References.html#ref-Krueger2009" role="doc-biblioref">2009</a>)</span>, shaping allows an agent to develop sub-strategies for solving complex tasks. These can be kept in memory and be reactivated when an agent faces new but similar problems. Our model develops one sub-strategy within each step of shaping. When facing new tasks, it will use prior strategies in parallel with developing new ones and thus constantly enlarges its knowledge about its environment (cf. <a href="#sec-nn:analysis" class="quarto-xref"><span>Section 4.3.2</span></a>). By quickly re-learning previous WM-motor strategies and by generalizing from previous strategies (cf. <a href="#sec-nn:analysis" class="quarto-xref"><span>Section 4.3.2</span></a>), our model’s dependency on shaping for solving complex tasks gradually decreases. It thereby gives an explanation of how high-level cognitions can develop from basic cognitive operations.</p>
</section>
<section id="limitations-of-the-model" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="limitations-of-the-model">Limitations of the model</h4>
<p>The model employs a considerable number of simplifications: it does not contain the indirect BG pathway. This pathway and its predominantly D2-type dopamine receptors appear to be prominently engaged in learning to reverse dominant behaviors <span class="citation" data-cites="Izquierdo2006 Lee2007 Tanimura2011">(<a href="References.html#ref-Izquierdo2006" role="doc-biblioref">Izquierdo et al., 2006</a>; <a href="References.html#ref-Lee2007" role="doc-biblioref">Lee et al., 2007</a>; <a href="References.html#ref-Tanimura2011" role="doc-biblioref">Tanimura et al., 2011</a>)</span>. Also, the hyperdirect pathway of the motor loop has been omitted. Empirically, it appears to provide (relatively global) stop signals to prevent execution of responses <span class="citation" data-cites="Aron2006 Eagle2008">(<a href="References.html#ref-Aron2006" role="doc-biblioref">Aron and Poldrack, 2006</a>; <a href="References.html#ref-Eagle2008" role="doc-biblioref">Eagle et al., 2008</a>)</span>. This paper is restricted to the functions of response selection, WM maintenance and WM updating as required by most basic WM tasks. Therefore, we do not model these additional pathways. As a further simplification, we do not consider exact timing of responses: as stated in <a href="#sec-nn:setup" class="quarto-xref"><span>Section 4.2.2</span></a>, the motor responses of the model are read out at predefined time-steps. Each decision about reward delivery thus depends upon the dominant response at only one particular time-step—and therefore neither upon the latency nor the duration of the response. Moreover, as the focus of this paper is on the contribution of BG reinforcement learning processes to the establishment of WM control and response selection, we do not provide an interpretation on the contribution of prefrontal dopamine signals to WM processes.</p>
</section>
<section id="comparison-to-other-computational-models-of-reinforcement-learning-in-bg" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="comparison-to-other-computational-models-of-reinforcement-learning-in-bg">Comparison to other computational models of reinforcement learning in BG</h4>
<p>A prominent account of the role of BG in WM is the PBWM model proposed by <span class="citation" data-cites="OReilly2006">O’Reilly and Frank (<a href="References.html#ref-OReilly2006" role="doc-biblioref">2006</a>)</span>. They provide a model of prefrontal cortico-BG-thalamic loop functioning, not including any explicit motor loop. This model requires BG for gating stimuli into prefrontal cortex while maintenance of information is subserved by locally self-excitatory prefrontal cortical loops; the direct and indirect BG pathways provide Go and NoGo signals for WM update, respectively. These assumptions contrast with our suppositions, implicating the whole cortico-BG-thalamic loop, via the direct BG pathway, in learning to maintain information (however, we agree that in well-learned tasks cortico-cortical connections might progressively take over control and supercede BG participation). Existing empirical evidence does not clearly favor one or the other assumption as several types of task-related activity seem to exist in striatal neurons. <span class="citation" data-cites="Cromwell2003">Cromwell and Schultz (<a href="References.html#ref-Cromwell2003" role="doc-biblioref">2003</a>)</span> for instance found five such types in a spatial DR task. Consistent with our approach, one of these types showed sustained activity for the whole delay period. The relatively small number of cells in GPi <span class="citation" data-cites="Lange1976">(<a href="References.html#ref-Lange1976" role="doc-biblioref">Lange et al., 1976</a>)</span> might at first sight argue against our hypothesis that WM maintenance is learned via cortico-BG-thalamic loops. But note that other types of connections (e.g.&nbsp;cortico-cortical ones) might develop as WM maintenance of a particular stimulus has been reliably learned, and release GPi to learn something new.</p>
<p><span class="citation" data-cites="Ashby2007">Ashby et al. (<a href="References.html#ref-Ashby2007" role="doc-biblioref">2007</a>)</span> propose a single-loop model of perceptual category learning (SPEED) that does not account for WM. They use a three-factor learning rule, much like ours, to map cortical representations onto striatal cells. However, BG learning is restricted to cortico-striatal connections, thus rendering their model less powerful in stimulus-response mapping. In particular, it will have severe problems mapping stimuli onto responses when relevant information lies within stimulus compounds instead of single stimuli. By allowing cortico-cortical connections to shortcut BG in case of well-learned, automatic behavior, however, their model provides an interesting concept beyond the scope of our model.</p>
<p><span class="citation" data-cites="Brown2004">Brown et al. (<a href="References.html#ref-Brown2004" role="doc-biblioref">2004</a>)</span> present an account of how learning within a single cortico-BG-thalamic loop assists in deciding between reactive and planned behaviors. Their TELOS model manages to learn several saccadic tasks and offers much anatomical detail. The authors assume cortico-cortical learning to be subject to the same phasic dopamine modulation as learning between cortex and BG. As explained above, this assumption is somewhat challenged by the long-lasting nature of prefrontal dopamine signals. WM is modeled as a hard-coded entity that is anatomically restricted to PFC: visual representations are predetermined to be gated in when PFC activity surmounts a certain threshold and to be deleted from it when the next sufficiently strong input appears.</p>
<p><span class="citation" data-cites="Vitay2010">Vitay and Hamker (<a href="References.html#ref-Vitay2010" role="doc-biblioref">2010</a>)</span> propose a computational account on how learning in BG guides visual attention in Delayed-Match-to-Sample and Delayed-Paired-Association tasks. The model contains only one cortico-BG-thalamic loop which is connected to infero-temporal cortex. It does not have the abilities to learn WM control. BG connectivity is restricted to the direct pathway. We here adapt and extend their account to model WM and motor control. To that end, we kept the general procedure of computing membrane potentials and firing rates. We also kept the concept of three-factor learning rules within BG—but sophisticated them to contain calcium eligibility traces. We newly devised an architecture of parallel cortico-BG-thalamic loops and allowed for interactions among these loops. We included additional BG nuclei and pathways and made the lateral inhibition in GPi independent of dopaminergic modulation to improve the model’s performance and to be in better accord with empirical data.</p>
</section>
<section id="predictions" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="predictions">Predictions</h4>
<p>Our model provides falsifiable predictions with regard to both behavioral and electrophysiological data. It predicts that re-organization of overt responses (i.e.&nbsp;within motor loops) is faster than a re-organization of WM control (i.e.&nbsp;within prefrontal loops). In particular, tasks that can be learned by utilizing a previously valid strategy of WM control (i.e.&nbsp;tasks in which only responses have to be adapted) will be learned significantly faster than tasks for which no previous strategy of WM control is available (cf. <a href="#sec-nn:analysis" class="quarto-xref"><span>Section 4.3.2</span></a>). Experimentally, this can be investigated by training animals or infant humans on the unconditional DR task described in <a href="#sec-nn:setup" class="quarto-xref"><span>Section 4.2.2</span></a> and by then changing the rules without announcement. In one condition, the same stimuli as in the original DR task will be used, but responses will have to be reversed to obtain reward. In the other condition, two new stimuli will be introduced, each of which has to be associated to one of the two responses. Our model predicts that the first condition will be learned significantly faster than the second one. The experimenter should use stimuli that the animal or infant has never seen before.</p>
<p>As we designed our shaping procedure to optimally suit the learning algorithms of our model, experimental evidence about the procedure’s adequacy tells about the biological plausibility of our algorithms. For the 1-2-AX task, we propose that in a first step of shaping, only the outer-loop stimuli 1 and 2 should be presented while in a second step, the outer-loop stimuli plus the inner-loop stimuli A,BA,B and CC should be shown. The efficiency of this procedure can for instance be compared to the protocol that <span class="citation" data-cites="Krueger2009">Krueger and Dayan (<a href="References.html#ref-Krueger2009" role="doc-biblioref">2009</a>)</span> propose to train an LSTM network <span class="citation" data-cites="Hochreiter1997">(<a href="References.html#ref-Hochreiter1997" role="doc-biblioref">Hochreiter and Schmidhuber, 1997</a>)</span>. Showing our procedure to establish the desired behavior faster and more reliably will be a piece of evidence for the biological plausibility of our approach.</p>
<p>Neurophysiologically, our model makes clear predictions about the functions of BG nuclei: STN (via the hyperdirect pathway) is assumed to provide reset signals for WM update in prefrontal loops. STN lesions that are confined to prefrontal loops should thus result in severe difficulties to flexibly update WM. We predict that those lesions will cause failures to delete previously maintained stimuli from WM in delayed match to sample tasks. This will show up as perseverative errors, i.e.&nbsp;subjects will continue to base their answers on stimuli that were relevant in previous trials. The caudate nucleus (via the direct pathway) is supposed to support WM maintenance. Lesions should result in impairments to learn maintenance of stimuli in WM. In a delayed match to sample task, this will show up as an increase in ‘random’ (i.e.&nbsp;unsystematic) errors. Putamen is supposed to establish associations between WM content and appropriate responses. Lesions will cause severe impairments in learning stimulus-response associations. The impact on well-learned behavior, however, is less clear due to a potential buildup of cortico-cortical connectivity. Another physiological prediction is the increase in the number of active SNc neurons when a highly expected reward does not occur (i.e.&nbsp;after reward contingencies change in an unpredictable way). PPN lesions should attenuate SNc recruitment. Heightened SNc activity is supposed to correspond with an increase in alertness and concentration.</p>
</section>
<section id="conclusion" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="conclusion">Conclusion</h4>
<p>We propose an anatomically detailed computational model of how reinforcement learning contributes to the organization of WM and overt response behavior. To our knowledge, our model is the first to prove the functional flexibility of cortico-BG-thalamic loops: we show that both WM control and response selection can develop in parallel within separate but interacting loops. Within this framework, we show how complex cognitive operations can develop from basic strategies of WM control and response selection.</p>
</section>
<section id="acknowledgments" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="acknowledgments">Acknowledgments</h4>
<p>This work has been supported by the German Research Foundation (Deutsche Forschungsgemeinschaft) grant “The cognitive control of visual perception and action selection” (DFG HA2630/4-2) and by the EC Project FP7-ICT “Eyeshots: Heterogeneous 3-D Perception across Visual Fragments”.</p>
</section>
<section id="appendix-a.-full-list-of-equations" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="appendix-a.-full-list-of-equations">Appendix A. Full list of equations</h3>
<p>We here give a full overview on the model’s equations that will allow to reproduce the model. To facilitate reading and allow for an easy comparison, all parameters are shown in Table and Table . <a href="#eq-nn:etaCa" class="quarto-xref">Equation&nbsp;<span>4.4</span></a>, <a href="#eq-nn:alpha" class="quarto-xref">Equation&nbsp;<span>4.6</span></a> and <a href="#eq-nn:da" class="quarto-xref">Equation&nbsp;<span>4.7</span></a> of the main text identically apply to all learning rules unless a deviation is specified.</p>
<section id="cortex-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="cortex-1">Cortex</h4>
<p>Membrane potentials (<span class="math inline">m_i^\text{Cx}(t)</span>) and firing rates (<span class="math inline">u_i^\text{Cx}(t)</span>) of prefrontal and motor cortical cells are given by</p>
<p><span class="math display">
    \tau \cdot \frac{d m_i^\text{Cx}(t)}{dt} + m_i^\text{Cx}(t) = w_{i,i}^\text{Cx–Cx} \cdot u_i^\text{ITC}(t) + \sum_{j \in \text{Thal}} w_{i,j}^\text{Thal–Cx}(t) \cdot u_j^\text{Thal}(t) + M + \epsilon_i(t)
</span></p>
<p><span id="eq-nn:cortex"><span class="math display">
    u_i^\text{Cx}(t) = \begin{cases} 0 \qquad \text{if } m_i^\text{Cx}(t) &lt; 0 \\
                                    m_i^\text{Cx}(t) \qquad \text{if } 0 \leq m_i^\text{Cx}(t) \leq 0.7 \\
                                    0.2 + \frac{1}{1 + \exp \frac{0.7 - m_i^\text{Cx}(t)}{2} } \qquad \text{if } m_i^\text{Cx}(t) &gt; 0.7
                        \end{cases}
\tag{4.8}</span></span></p>
<p>ITC simply reproduces sensory input. As motivated by <span class="citation" data-cites="Vitay2010">Vitay and Hamker (<a href="References.html#ref-Vitay2010" role="doc-biblioref">2010</a>)</span>, the transfer function of <a href="#eq-nn:cortex" class="quarto-xref">Equation&nbsp;<span>4.8</span></a> ensures that a broad range of membrane potentials above the value of 0.75 results in a relatively constant firing rate. This guarantees more stability in maintaining eligible WM representations in prefrontal loops when visual stimulation ends. Thalamo-cortical weights (<span class="math inline">w_{i,j}^\text{Thal-Cx}(t)</span>) are updated according to</p>
<p><span class="math display">
     \eta  \cdot \frac{d w_{i,j}^\text{Thal-Cx}(t)}{dt} = (u_j^\text{Thal}(t) - \overline{\text{Thal}}(t)) \cdot (u_i^\text{Cx}(t) - \overline{\text{Cx}}(t) - \gamma)- \alpha_i(t) \cdot (u_i^\text{Cx}(t) - \overline{\text{Cx}}(t))^2 \cdot w_{i,j}^\text{Thal-Cx}(t)
</span></p>
<p>The threshold parameter <span class="math inline">\gamma</span> ensures that only those prefrontal cells become associated to thalamic neurons that are activated by visual stimulation (i.e.&nbsp;not just by random noise). Weights are impeded to decrease below zero. Cortico-cortical weights from ITC to lPFC (<span class="math inline">w_{i,j}^\text{Cx-Cx}(t)</span>) are updated according to:</p>
<p><span class="math display">
\begin{aligned}
  \eta  \cdot \frac{d w_{i,j}^\text{Cx-Cx}(t)}{dt} &amp; = (u_j^{\text{Cx}_\text{ITC}}(t) - \overline{\text{Cx}_\text{ITC}}(t))^+ \cdot  (u_i^{\text{Cx}_\text{PFC}}(t) - \overline{\text{Cx}_\text{PFC}}(t)) \\
        &amp; - \alpha_i(t) \cdot (u_j^{\text{Cx}_\text{ITC}}(t) - \overline{\text{Cx}_\text{ITC}}(t)) \cdot ((u_i^{\text{Cx}_\text{PFC}}(t) - \overline{\text{Cx}_\text{PFC}}(t)) \cdot w_{i,j}^\text{Cx-Cx}(t) \\
\end{aligned}
</span></p>
<p>Weights are not allowed to decrease below zero.</p>
</section>
<section id="thalamus-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="thalamus-1">Thalamus</h4>
<p>Membrane potentials (<span class="math inline">m_i^\text{Thal}(t)</span>) and firing rates (<span class="math inline">u_i^\text{Thal}(t)</span>) of thalamic neurons are governed by</p>
<p><span class="math display">
    \tau \cdot \frac{d m_i^\text{Thal}(t)}{dt} + m_i^\text{Thal}(t) = w_{i,i}^\text{GPi–Thal} \cdot u_i^\text{GPi}(t) + \sum_{j \in \text{Cx}} w_{i,j}^\text{Cx-Thal}(t) \cdot u_j^\text{Cx}(t) + M + \epsilon_i(t)
</span></p>
<p><span class="math display">
u_i^\text{Thal}(t)=(m_i^\text{Thal}(t))^+
</span></p>
<p>Cortico-thalamic weights (<span class="math inline">w_{i,j}^\text{Cx–Thal}(t)</span>) are updated according to <span class="math display">
  \eta  \cdot \frac{d w_{i,j}^\text{Cx–Thal}(t)}{dt} = (u_j^\text{Cx}(t) - \overline{\text{Cx}}(t) )^+ \cdot (u_i^\text{Thal}(t) - \overline{\text{Thal}}(t) - \gamma) - \alpha_i(t) \cdot (u_i^\text{Thal}(t) - \overline{\text{Thal}}(t))^2 \cdot w_{i,j}^\text{Cx–Thal}(t)
</span></p>
<p>Weights are impeded to decrease below zero.</p>
</section>
<section id="striatum-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="striatum-1">Striatum</h4>
<p>Membrane potentials (<span class="math inline">m_i^\text{Str}(t)</span>) and firing rates (<span class="math inline">u_i^\text{Str}(t)</span>)) of striatal cells are governed by</p>
<p><span class="math display">
\tau \cdot \frac{d u_i^\text{Str}(t)}{dt} + u_i^\text{Str}(t) = \sum_{j \in \text{Cx}} w_{i,j}^\text{Cx–Str}(t) \cdot u_j^\text{Cx}(t) + \sum_{j \in \text{Str}, j \neq i} w_{i,j}^\text{Str–Str} \cdot u_j^\text{Str}(t) + M + \epsilon_i(t)
</span></p>
<p><span class="math display">
u_i^\text{Str}(t) = (m_i^\text{Str}(t))^+
</span></p>
<p>Cortico-striatal weights (<span class="math inline">w_{i,j}^\text{Cx-Str}(t)</span>) are updated by the following calcium trace dependent three-factor learning rule:</p>
<p><span class="math display">
  \eta^\text{Ca} \cdot \frac{d \text{Ca}_{i,j}^\text{Str}(t)}{dt} + \text{Ca}_{i,j}^\text{Str}(t) = (u_j^\text{Cx}(t) - \overline{\text{Cx}}(t) - \gamma)(u_i^\text{Str}(t) \overline{\text{Str}}(t))^+
</span></p>
<p><span class="math display">
  \eta  \cdot \frac{ d w_{i,j}^\text{Cx-Str}(t)}{dt} = f_\text{DA} (\text{DA}(t) - \text{DA}_\text{base} ) \cdot \text{Ca}_{i,j}^\text{Str}(t) - \alpha_i(t) \cdot (u_i^\text{Str}(t) - \overline{\text{Str}}(t))^2 \cdot w_{i,j}^\text{Cx-Str}(t)
</span></p>
<p><span class="math inline">\gamma</span> encourages weights to become negative, thereby instigating different inputs to connect to non-overlapping clusters of striatal representations.</p>
</section>
<section id="subthalamic-nucleus-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="subthalamic-nucleus-1">Subthalamic nucleus</h4>
<p>Membrane potentials (<span class="math inline">m_i^\text{STN}(t)</span>) and firing rates (<span class="math inline">u_i^\text{STN}(t)</span>)) of STN cells are governed by</p>
<p><span class="math display">
\tau \cdot \frac{d u_i^\text{STN}(t)}{dt} + u_i^\text{STN}(t) = w_{i,i}^\text{Cx-STN}(t) \cdot u_i^\text{Cx}(t) + M +  \epsilon_i(t)
</span></p>
<p><span class="math display">
u_i^\text{STN}(t) = \begin{cases}
                    0 \qquad \text{if } m_i^\text{STN} (t) &lt;  0 \\
                    m_i^\text{STN} (t) \qquad \text{if } 0 \leq m_i^\text{STN} (t) \leq 1 \\
                    0.5 + \frac{1}{1 + \exp \frac{1 - m_i^\text{STN}(t)}{2} } \qquad \text{if } m_i^\text{STN}(t) &gt; 1
                    \end{cases}
</span></p>
<p>Cortico-subthalamic weights (<span class="math inline">w_{i,j}^\text{Cx-STN}(t)</span>) are updated according to</p>
<p><span class="math display">
  \eta^\text{Ca} \cdot \frac{d \text{Ca}_{i,i}^\text{STN}(t)}{dt} + \text{Ca}_{i,i}^\text{STN}(t) = (u_i^\text{Cx}(t) - \overline{\text{Cx}}(t))^+ \cdot (u_i^\text{STN}(t) - \overline{\text{STN}}(t) -\gamma)^+
</span></p>
<p><span class="math display">
  \eta \cdot \frac{d w_{i,i}^\text{Cx-STN}(t)}{dt} = f_\text{DA}(\text{DA}(t)-\text{DA}_\text{base}) \cdot \text{Ca}_{i,i}^\text{STN}(t)- \alpha_i(t) (u_i^\text{STN}(t) - \overline{\text{STN}}(t))^2 \cdot w_{i,i}^\text{Cx-STN}(t)
</span></p>
<p><span class="math inline">\gamma</span> again ensures that only those prefrontal cells become associated to subthalamic neurons that receive visual stimulation. Weights are restricted to not decrease below zero.</p>
</section>
<section id="globus-pallidus-external-segment-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="globus-pallidus-external-segment-1">Globus pallidus external segment</h4>
<p>Membrane potentials (<span class="math inline">m_i^\text{GPe}(t)</span>) and firing rates (<span class="math inline">u_i^\text{GPe}(t)</span>) of GPe cells are given by</p>
<p><span class="math display">
\tau \cdot \frac{d u_i^\text{GPe}(t)}{dt} + u_i^\text{GPe}(t) = w_{i,i}^\text{STN-GPe} \cdot u_i^\text{STN}(t) + M + \epsilon_i(t)
</span> <span class="math display">
u_i^\text{GPe}(t) = (m_i^\text{GPe}(t))^+
</span></p>
</section>
<section id="globus-pallidus-internal-segment-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="globus-pallidus-internal-segment-1">Globus pallidus internal segment</h4>
<p>GPi membrane potentials (<span class="math inline">m_i^\text{GPi}(t)</span>) and firing rates (<span class="math inline">u_i^\text{GPi}(t)</span>) are ruled by</p>
<p><span class="math display">
\begin{aligned}
    \tau \cdot \frac{d m_i^\text{GPi}(t)}{dt} + m_i^\text{GPi}(t) &amp;= \sum_{j \in \text{Str}} w_{i,j}^\text{Str-GPi}(t) \cdot u_j^\text{Str}(t) + \sum_{j \in \text{GPi}, j \neq i } w_{i,j}^\text{GPi-GPi} \cdot (M - u_j^\text{GPi}(t))^+ \\
    &amp;+ \sum_{j \in \text{STN}} w_{i,j}^\text{STN-GPi} \cdot u_j^{STN}(t)+ \sum_{j \in \text{GPe}} w_{i,j}^\text{GPe-GPi} \cdot u_j^{GPe}(t) + M + \epsilon_i(t) \\
\end{aligned}
</span></p>
<p>GPi has a high baseline firing rate; low GPi firing rates denote high activity in a functional sense. Lateral afferents therefore have the presynaptic term <span class="math inline">(M - u_j^\text{GPi}(t))^+</span>: the lower the firing rate of a GPi cell, the higher its impact on other cells. The transfer function of <a href="#eq-nn:transferfunction" class="quarto-xref">Equation&nbsp;<span>4.9</span></a> ensures a slow increase of firing rates when membrane potentials rise above the value of 1.0. Striatal afferents are learnable while subthalamic and external pallidal inputs are assumed to be hard-coded for simplicity. Striato-pallidal inhibitory weights (<span class="math inline">w_{i,j}^\text{Str-GPi}(t)</span>) evolve according to</p>
<p><span class="math display">
  \eta^\text{Ca} \cdot \frac{d \text{Ca}_{i,j}^\text{GPi}(t)}{dt} + \text{Ca}_{i,j}^\text{GPi}(t) = (u_j^\text{Str}(t) - \overline{\text{Str}}(t))^+ \cdot g(\overline{\text{GPi}}(t) - u_i^\text{GPi}(t))
</span></p>
<p><span id="eq-nn:transferfunction"><span class="math display">
g(x)= \frac{1}{1+\exp-2x} - 0.6
\tag{4.9}</span></span> <span class="math display">
  \eta \cdot \frac{d w_{i,j}^\text{Str-GPi}(t)}{dt} = - f_\text{DA}(\text{DA}(t)-\text{DA}_\text{base}) \cdot \text{Ca}_{i,j}^\text{GPi}(t) - \beta \cdot  \alpha_i(t) \cdot (\overline{\text{GPi}}(t) - u_i^\text{GPi}(t))^2 \cdot w_{i,j}^\text{Str-GPi}(t)
</span> <span class="math display">
\tau_\alpha  \cdot \frac{d \alpha_i(t)}{dt} + \alpha_i(t) = (-m_i^\text{GPi}(t) - 1.0)^+
</span></p>
<p>The constant <span class="math inline">\beta</span> attenuates the strength of the regularization term. The sigmoidal function <span class="math inline">g(x)</span> guarantees selectivity of striato-pallidal mappings by ensuring a clear separation between GPi firing rates that favor an increase of striato-pallidal weights and those that favor a decrease of weights. <span class="math inline">\alpha_i(t)</span> increases when (<span class="math inline">-m_i^\text{GPi}(t)-1.0</span>) becomes positive. Weights are restricted to not become larger than zero. Lateral weights (<span class="math inline">w_{i,j}^\text{GPi-GPi}(t)</span>) evolve according to</p>
<p><span class="math display">
  \eta \cdot \frac{d w_{i,j}^\text{GPi-GPi}(t)}{dt} = (\overline{\text{GPi}}(t) - u_j^\text{GPi}(t))^+ \cdot (\overline{\text{GPi}}(t) - u_i^\text{GPi}(t))^+ - \beta \cdot  \alpha_i(t) \cdot (\overline{\text{GPi}}(t) - u_i^\text{GPi}(t))^2 \cdot w_{i,j}^\text{GPi-GPi}(t)
</span></p>
<p>Weights are restricted to not become smaller than zero.</p>
</section>
<section id="substantia-nigra-pars-compacta-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="substantia-nigra-pars-compacta-1">Substantia nigra pars compacta</h4>
<p>Membrane potentials (<span class="math inline">m_i^\text{DA}(t)</span>) and firing rates (<span class="math inline">u_i^\text{DA}(t)</span>) of SNc cells are given by</p>
<p><span class="math display">
\tau \cdot \frac{d m_i^\text{DA}(t)}{dt} + m_i^\text{DA}(t) = R(t) + P(t) \cdot \sum_{j \in \text{Str}} w_{i,j}^\text{Str-SNc}(t) \cdot u_j^\text{Str}(t) + \text{DA}_\text{base}
</span> <span class="math display">
\text{DA}i(t)=(m_i^\text{DA}(t))^+
</span></p>
<p>Reward <span class="math inline">R(t)</span> is set to 0.5 when received and to 0.0 otherwise; when above zero, <span class="math inline">R(t)</span> decreases by one-thousandth of its value at each time step. The timing factor of reward prediction <span class="math inline">P(t)</span> is set to 1.0 when reward is expected and to 0.0 else. For the time constant <span class="math inline">\tau</span> we chose a relatively small value of 10 ms to set only a small temporal delay between reward-related events (i.e.&nbsp;rewards and their omissions) and changes in SNc firing (that then cause phasic changes in dopamine levels). Thereby, we ensure that the time period where reward-related events (i.e.&nbsp;via dopamine) are associated to neuronal eligibility traces (<span class="math inline">d\text{Ca}_{i,j}^\text{post}(t)</span>) is temporally close to when these events take place. Larger values of <span class="math inline">\tau</span> would result in eligibility traces decaying further before dopamine levels rise. This would result in smaller weight changes per trial and would thereby slow down learning of WM control and response selection. Furthermore, much larger values of <span class="math inline">\tau</span> could be problematic in case of short inter-trial-intervals since reward-related events could then be associated to future (instead of previous) eligibility traces.</p>
<p>Learnable, negatively weighted striato-nigral afferents encode reward prediction. Depending on the balance between actual reward and reward prediction, firing rates above or below the baseline level (<span class="math inline">\text{DA}_\text{base}</span>) of 0.5 can result. Striato-nigral weights (<span class="math inline">w_{i,j}^\text{Str-SNc}(t)</span>) encoding reward prediction are learned via</p>
<p><span class="math display">
  \eta  \cdot \frac{d w_{i,j}^\text{Str-SNc}(t)}{dt} = - (u_j^\text{Str}(t) - \overline{\text{Str}}(t) ) + f_\text{DA}(\text{DA}_i(t) - \text{DA}_\text{base})
</span></p>
<p>The postsynaptic and the dopaminergic term are identical in this equation, resulting in a two-factor “Hebbian” learning rule.</p>
</section>
<section id="relationship-between-motor-activity-and-overt-responses" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="relationship-between-motor-activity-and-overt-responses">Relationship between motor activity and overt responses</h4>
<p>To account for imprecision in the motor command system, response selection is assumed to be based upon brain activity in a probabilistic way: The higher the activity of a particular MI cell, the greater the probability of the associated response. In case of equal activity among motor cells, the probability of each response is the inverse of the number of possible alternatives. The probability of response <span class="math inline">R_i</span> is therefore given by</p>
<p><span class="math display">
    P(R_i) = 0.5 + u_i - u_j
</span></p>
<p>where <span class="math inline">u_i</span> is the firing rate of the cell associated to the response <span class="math inline">R_i</span> and <span class="math inline">u_j</span> the firing rate of the respective other MI cell. Probability values are reasonably restricted to the interval <span class="math inline">[0, 1]</span>.</p>
</section>
</section>
<section id="appendix-b.-number-of-simulated-cells" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="appendix-b.-number-of-simulated-cells">Appendix B. Number of simulated cells</h3>
<p><a href="#tbl-nn:numbercells" class="quarto-xref">Table&nbsp;<span>4.1</span></a> presents the numbers of cells in each of the model’s layers. The two prefrontal loops each contain eight cells within lPFC, STN, GPe and GPi so that each of the 1-2-AX task’s stimuli can in principle become represented within at least one cell. MI contains two cells: one for each response. The number of striatal cells has to be considerably larger since clusters of striatal cells become receptive to various combinations of cortical afferents. The motor part of striatum exceeds the prefrontal part in size as cells from all cortical areas have to converge there.</p>
<div id="tbl-nn:numbercells" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nn:numbercells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.1: Numbers of cells within the model’s layers. GPe: globus pallidus external segment; GPi: globus pallidus internal segment; SNc: substantia nigra pars compacta; STN: subthalamic nucleus.
</figcaption>
<div aria-describedby="tbl-nn:numbercells-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Cell type</th>
<th>Prefrontal loop</th>
<th>Motor loop</th>
<th>Visual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cortex</td>
<td>8</td>
<td>2</td>
<td>8</td>
</tr>
<tr class="even">
<td>Striatum</td>
<td>25</td>
<td>49</td>
<td>0</td>
</tr>
<tr class="odd">
<td>STN</td>
<td>8</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>GPe</td>
<td>8</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>GPi</td>
<td>8</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="even">
<td>Thalamus</td>
<td>8</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="odd">
<td>SNc</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="appendix-c.-overview-of-model-parameters" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="appendix-c.-overview-of-model-parameters">Appendix C. Overview of model parameters</h3>
<p>To allow for an easy overview and comparison of the model’s parameters, these are systematically listed in <a href="#tbl-nn:parameters" class="quarto-xref">Table&nbsp;<span>4.2</span></a> and <a href="#tbl-nn:connections" class="quarto-xref">Table&nbsp;<span>4.3</span></a>. <a href="#tbl-nn:parameters" class="quarto-xref">Table&nbsp;<span>4.2</span></a> contains the parameters for computing membrane potentials and firing rates, <a href="#tbl-nn:connections" class="quarto-xref">Table&nbsp;<span>4.3</span></a> the parameters for computing weights.</p>
<div id="tbl-nn:parameters" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nn:parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.2: Parameters for computations of membrane potentials and firing rates. The table shows time constants (<span class="math inline">\tau</span>), feedforward weights (<span class="math inline">w^\text{ff}</span>), lateral weights (<span class="math inline">w^\text{lat}</span>), baseline membrane parameters (<span class="math inline">M</span>) and random noise terms (<span class="math inline">\epsilon</span>) for each of the model’s layers. All learnable weights (denoted by <span class="math inline">l</span>) are randomly initialized with values between 0.05 and 0.10, except for connections from inferior temporal to lateral prefrontal cortex (<span class="math inline">w_{i,i}^\text{Cx-Cx}</span>) which are uniformly initialized with 0.1. Cx: cortex; GPe: globus pallidus external segment; GPi: globus pallidus internal segment; SNc: substantia nigra pars compacta; STN: subthalamic nucleus; Str: striatum; Thal: thalamus. <span class="math inline">^a</span>: Weights are of this value for the motor loop only while they are learnable in prefrontal loops.
</figcaption>
<div aria-describedby="tbl-nn:parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 18%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 3%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Cell type</th>
<th><span class="math inline">\tau</span> (ms)</th>
<th><span class="math inline">w^\text{ff}</span></th>
<th><span class="math inline">w^\text{ff}</span></th>
<th><span class="math inline">w^\text{ff}</span></th>
<th><span class="math inline">w^\text{lat}</span></th>
<th><span class="math inline">M</span></th>
<th><span class="math inline">\epsilon</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cx</td>
<td>5</td>
<td><span class="math inline">w^\text{Thal-Cx}</span>: 1.0<span class="math inline">^a</span></td>
<td><span class="math inline">w^\text{Cx-Cx}</span>: 0.0<span class="math inline">^a</span></td>
<td>-</td>
<td>-</td>
<td>0.0</td>
<td>[-0.05; 0.05]</td>
</tr>
<tr class="even">
<td>Str</td>
<td>10</td>
<td><span class="math inline">w^\text{Cx-Str}</span>: l</td>
<td>-</td>
<td>-</td>
<td><span class="math inline">w^\text{Str-Str}</span>: -0.3</td>
<td>0.3</td>
<td>[-0.1; 0.1]</td>
</tr>
<tr class="odd">
<td>STN</td>
<td>10</td>
<td><span class="math inline">w^\text{Cx-STN}</span>: l</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0.0</td>
<td>[-0.01; 0.01]</td>
</tr>
<tr class="even">
<td>GPe</td>
<td>50</td>
<td><span class="math inline">w^\text{STN-GPe}</span>: 1.0</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0.0</td>
<td>[-0.1; 0.1]</td>
</tr>
<tr class="odd">
<td>GPi</td>
<td>10</td>
<td><span class="math inline">w^\text{Str-GPi}</span>: l</td>
<td><span class="math inline">w^\text{STN-GPi}</span>: 8.0</td>
<td><span class="math inline">w^\text{GPe-GPi}</span>: -8.0</td>
<td><span class="math inline">w^\text{GPi-GPi}</span>: 1.0<span class="math inline">^a</span></td>
<td>0.8</td>
<td>[-0.75; 0.75]</td>
</tr>
<tr class="even">
<td>Thal</td>
<td>5</td>
<td><span class="math inline">w^\text{Cx-Thal}</span>: 0.5<span class="math inline">^a</span></td>
<td><span class="math inline">w^\text{GPi-Thal}</span>:-1.0</td>
<td>-</td>
<td>-</td>
<td>0.7</td>
<td>[-0.1; 0.1]</td>
</tr>
<tr class="odd">
<td>SNc</td>
<td>10</td>
<td><span class="math inline">w^\text{Str-SNc}</span>: l</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0.5</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="tbl-nn:connections" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nn:connections-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4.3: Parameters for computations of weights. The table shows time constants (<span class="math inline">\eta</span> and <span class="math inline">\tau_\alpha</span>), threshold parameters (<span class="math inline">\gamma</span>), parameters controlling the relative strength of long-term depression (<span class="math inline">\varphi</span>), parameters controlling the speed of calcium increase (<span class="math inline">\eta^\text{inc}</span>) and decline (<span class="math inline">\eta^\text{dec}</span>), parameters controlling the maximal desired firing rates for cells with learnable inputs (<span class="math inline">u^\text{MAX}</span>), homeostatic regularization factors (<span class="math inline">\beta</span>) and parameters controlling the speed of increases of <span class="math inline">\alpha_i</span> (<span class="math inline">K_\alpha</span>) for each of the model’s connection types; when two values are given, the first corresponds to the motor loop and the second to prefrontal loops. Cx: cortex; GPi: globus pallidus internal segment; SNc: substantia nigra pars compacta; STN: subthalamic nucleus; Str: striatum; Thal: thalamus.
</figcaption>
<div aria-describedby="tbl-nn:connections-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Connection type</th>
<th><span class="math inline">\eta</span> (ms)</th>
<th><span class="math inline">\tau_\alpha</span> (ms)</th>
<th><span class="math inline">\gamma</span></th>
<th><span class="math inline">\varphi</span></th>
<th><span class="math inline">\eta^\text{inc}</span> (ms)</th>
<th><span class="math inline">\eta^\text{dec}</span> (ms)</th>
<th><span class="math inline">u^\text{MAX}</span></th>
<th><span class="math inline">\beta</span></th>
<th><span class="math inline">K_\alpha</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">w^\text{Cx-Cx}</span></td>
<td>800</td>
<td>20</td>
<td>0.0</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1.0</td>
<td>-</td>
<td>10</td>
</tr>
<tr class="even">
<td><span class="math inline">w^\text{Thal-Cx}</span></td>
<td>450</td>
<td>20</td>
<td>0.25</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>1.0</td>
<td>-</td>
<td>10</td>
</tr>
<tr class="odd">
<td><span class="math inline">w^\text{Cx-Str}</span></td>
<td>250</td>
<td>20</td>
<td>0.55; 0.4</td>
<td>0.5; 0.1</td>
<td>1</td>
<td>500</td>
<td>1.0</td>
<td>-</td>
<td>10</td>
</tr>
<tr class="even">
<td><span class="math inline">w^\text{Cx-STN}</span></td>
<td>250</td>
<td>20</td>
<td>-</td>
<td>0.2</td>
<td>1</td>
<td>500</td>
<td>1.0</td>
<td>-</td>
<td>1</td>
</tr>
<tr class="odd">
<td><span class="math inline">w^\text{Str-GPi}</span></td>
<td>500</td>
<td>2</td>
<td>-</td>
<td>10.0; 0.2</td>
<td>1</td>
<td>250</td>
<td>-</td>
<td>0.03; 1.0</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">w^\text{GPi-GPi}</span></td>
<td>100</td>
<td>2</td>
<td>-</td>
<td>-</td>
<td>1</td>
<td>250</td>
<td>1.0</td>
<td>0.06</td>
<td>1</td>
</tr>
<tr class="odd">
<td><span class="math inline">w^\text{Cx-Thal}</span></td>
<td>700</td>
<td>20</td>
<td>0.1</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0.8</td>
<td>-</td>
<td>10</td>
</tr>
<tr class="even">
<td><span class="math inline">w^\text{Str-SNc}</span></td>
<td>10000</td>
<td>-</td>
<td>-</td>
<td>5.0</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-Alberts2008" class="csl-entry" role="listitem">
Alberts, J. L., Voelcker-Rehage, C., Hallahan, K., Vitek, M., Bamzai, R., and Vitek, J. L. (2008). Bilateral subthalamic stimulation impairs cognitive-motor performance in parkinson’s disease patients. <em>Brain</em> 131, 3348–3360. doi:<a href="https://doi.org/10.1093/brain/awn238">10.1093/brain/awn238</a>.
</div>
<div id="ref-Alegret2001" class="csl-entry" role="listitem">
Alegret, M., Junqué, C., Valldeoriola, F., Vendrell, P., Pilleri, M., Rumià, J., et al. (2001). <a href="https://www.ncbi.nlm.nih.gov/pubmed/11493162">Effects of bilateral subthalamic stimulation on cognitive function in parkinson disease.</a> <em>Arch Neurol</em> 58, 1223–1227.
</div>
<div id="ref-Alexander1986" class="csl-entry" role="listitem">
Alexander, G. E., DeLong, M. R., and Strick, P. L. (1986). Parallel organization of functionally segregated circuits linking the basal ganglia and cortex. <em>Ann Rev Neurosci</em> 9, 357–381.
</div>
<div id="ref-Aron2006" class="csl-entry" role="listitem">
Aron, A. R., and Poldrack, R. A. (2006). Cortical and subcortical contributions to stop signal response inhibition: Role of the subthalamic nucleus. <em>J Neurosci</em> 26, 2424–2433. doi:<a href="https://doi.org/10.1523/JNEUROSCI.4682-05.2006">10.1523/JNEUROSCI.4682-05.2006</a>.
</div>
<div id="ref-Ashby2007" class="csl-entry" role="listitem">
Ashby, F. G., Ennis, J. M., and Spiering, B. J. (2007). A neurobiological theory of automaticity in perceptual categorization. <em>Psychol Rev</em> 114, 632–656. doi:<a href="https://doi.org/10.1037/0033-295X.114.3.632">10.1037/0033-295X.114.3.632</a>.
</div>
<div id="ref-Bird2008" class="csl-entry" role="listitem">
Bird, C. M., and Burgess, N. (2008). The hippocampus and memory: Insights from spatial processing. <em>Nat Rev Neurosci</em> 9, 182–194. doi:<a href="https://doi.org/10.1038/nrn2335">10.1038/nrn2335</a>.
</div>
<div id="ref-Braak2008" class="csl-entry" role="listitem">
Braak, H., and Del Tredici, K. (2008). Cortico-basal ganglia-cortical circuitry in parkinson’s disease reconsidered. <em>Exp Neurol</em> 212, 226–229. doi:<a href="https://doi.org/10.1016/j.expneurol.2008.04.001">10.1016/j.expneurol.2008.04.001</a>.
</div>
<div id="ref-Brown2004" class="csl-entry" role="listitem">
Brown, J. W., Bullock, D., and Grossberg, S. (2004). How laminar frontal cortex and basal ganglia circuits interact to control planned and reactive saccades. <em>Neural Netw</em> 17, 471–510. doi:<a href="https://doi.org/10.1016/j.neunet.2003.08.006">10.1016/j.neunet.2003.08.006</a>.
</div>
<div id="ref-Brown1999" class="csl-entry" role="listitem">
Brown, J., Bullock, D., and Grossberg, S. (1999). <span class="nocase">How the basal ganglia use parallel excitatory and inhibitory learning pathways to selectively respond to unexpected rewarding cues.</span> <em>J. Neurosci.</em> 19, 10502–11. Available at: <a href="http://www.ncbi.nlm.nih.gov/pubmed/10575046">http://www.ncbi.nlm.nih.gov/pubmed/10575046</a>.
</div>
<div id="ref-Bunge2002" class="csl-entry" role="listitem">
Bunge, S. A., Hazeltine, E., Scanlon, M. D., Rosen, A. C., and Gabrieli, J. D. E. (2002). <a href="https://www.ncbi.nlm.nih.gov/pubmed/12414294">Dissociable contributions of prefrontal and parietal cortices to response selection.</a> <em>Neuroimage</em> 17, 1562–1571.
</div>
<div id="ref-Calzavara2007" class="csl-entry" role="listitem">
Calzavara, R., Mailly, P., and Haber, S. N. (2007). Relationship between the corticostriatal terminals from areas 9 and 46, and those from area 8A, dorsal and rostral premotor cortex and area 24c: An anatomical substrate for cognition to action. <em>Eur J Neurosci</em> 26, 2005–2024. doi:<a href="https://doi.org/10.1111/j.1460-9568.2007.05825.x">10.1111/j.1460-9568.2007.05825.x</a>.
</div>
<div id="ref-Cepeda1998" class="csl-entry" role="listitem">
Cepeda, C., Colwell, C. S., Itri, J. N., Chandler, S. H., and Levine, M. S. (1998). <a href="https://www.ncbi.nlm.nih.gov/pubmed/9425179">Dopaminergic modulation of NMDA-induced whole cell currents in neostriatal neurons in slices: Contribution of calcium conductances.</a> <em>J Neurophysiol</em> 79, 82–94.
</div>
<div id="ref-Chevalier1990" class="csl-entry" role="listitem">
Chevalier, G., and Deniau, J. M. (1990). <a href="https://www.ncbi.nlm.nih.gov/pubmed/1695403">Disinhibition as a basic process in the expression of striatal functions.</a> <em>Trends Neurosci</em> 13, 277–280.
</div>
<div id="ref-Cromwell2003" class="csl-entry" role="listitem">
Cromwell, H. C., and Schultz, W. (2003). Effects of expectations for different reward magnitudes on neuronal activity in primate striatum. <em>J Neurophysiol</em> 89, 2823–2838. doi:<a href="https://doi.org/10.1152/jn.01014.2002">10.1152/jn.01014.2002</a>.
</div>
<div id="ref-Delgado2005" class="csl-entry" role="listitem">
Delgado, M. R., Miller, M. M., Inati, S., and Phelps, E. A. (2005). An fMRI study of reward-related probability learning. <em>Neuroimage</em> 24, 862–873. doi:<a href="https://doi.org/10.1016/j.neuroimage.2004.10.002">10.1016/j.neuroimage.2004.10.002</a>.
</div>
<div id="ref-DeLong1990" class="csl-entry" role="listitem">
DeLong, M. R. (1990). <a href="https://www.ncbi.nlm.nih.gov/pubmed/1695404">Primate models of movement disorders of basal ganglia origin.</a> <em>Trends Neurosci</em> 13, 281–285.
</div>
<div id="ref-DeLong2007" class="csl-entry" role="listitem">
DeLong, M. R., and Wichmann, T. (2007). Circuits and circuit disorders of the basal ganglia. <em>Arch Neurol</em> 64, 20–24. doi:<a href="https://doi.org/10.1001/archneur.64.1.20">10.1001/archneur.64.1.20</a>.
</div>
<div id="ref-DiGiovanni2009" class="csl-entry" role="listitem">
Di Giovanni, G., and Shi, W.-X. (2009). Effects of scopolamine on dopamine neurons in the substantia nigra: Role of the pedunculopontine tegmental nucleus. <em>Synapse</em> 63, 673–680. doi:<a href="https://doi.org/10.1002/syn.20650">10.1002/syn.20650</a>.
</div>
<div id="ref-Eagle2008" class="csl-entry" role="listitem">
Eagle, D. M., Baunez, C., Hutcheson, D. M., Lehmann, O., Shah, A. P., and Robbins, T. W. (2008). Stop-signal reaction-time task performance: Role of prefrontal cortex and subthalamic nucleus. <em>Cereb Cortex</em> 18, 178–188. doi:<a href="https://doi.org/10.1093/cercor/bhm044">10.1093/cercor/bhm044</a>.
</div>
<div id="ref-Ebrahimi1992" class="csl-entry" role="listitem">
Ebrahimi, A., Pochet, R., and Roger, M. (1992). <a href="https://www.ncbi.nlm.nih.gov/pubmed/1380687">Topographical organization of the projections from physiologically identified areas of the motor cortex to the striatum in the rat.</a> <em>Neurosci Res</em> 14, 39–60.
</div>
<div id="ref-Featherstone2004" class="csl-entry" role="listitem">
Featherstone, R. E., and McDonald, R. J. (2004). Dorsal striatum and stimulus-response learning: Lesions of the dorsolateral, but not dorsomedial, striatum impair acquisition of a stimulus-response-based instrumental discrimination task, while sparing conditioned place preference learning. <em>Neuroscience</em> 124, 23–31. doi:<a href="https://doi.org/10.1016/j.neuroscience.2003.10.038">10.1016/j.neuroscience.2003.10.038</a>.
</div>
<div id="ref-Feenstra1996" class="csl-entry" role="listitem">
Feenstra, M. G., and Botterblom, M. H. (1996). <a href="https://www.ncbi.nlm.nih.gov/pubmed/9117391">Rapid sampling of extracellular dopamine in the rat prefrontal cortex during food consumption, handling and exposure to novelty.</a> <em>Brain Res</em> 742, 17–24.
</div>
<div id="ref-Feenstra2000" class="csl-entry" role="listitem">
Feenstra, M. G., Botterblom, M. H., and Mastenbroek, S. (2000). <a href="https://www.ncbi.nlm.nih.gov/pubmed/11036208">Dopamine and noradrenaline efflux in the prefrontal cortex in the light and dark period: Effects of novelty and handling and comparison to the nucleus accumbens.</a> <em>Neuroscience</em> 100, 741–748.
</div>
<div id="ref-Guillery2002" class="csl-entry" role="listitem">
Guillery, R. W., and Sherman, S. M. (2002). <a href="https://www.ncbi.nlm.nih.gov/pubmed/11804565">Thalamic relay functions and their role in corticocortical communication: Generalizations from the visual system.</a> <em>Neuron</em> 33, 163–175.
</div>
<div id="ref-Gurney2001" class="csl-entry" role="listitem">
Gurney, K., Prescott, T. J., and Redgrave, P. (2001). <a href="https://www.ncbi.nlm.nih.gov/pubmed/11417052">A computational model of action selection in the basal ganglia.<span> I. A </span>new functional anatomy.</a> <em>Biol Cybern</em> 84, 401–410.
</div>
<div id="ref-Haber2003" class="csl-entry" role="listitem">
Haber, S. N. (2003). <a href="https://www.ncbi.nlm.nih.gov/pubmed/14729134">The primate basal ganglia: Parallel and integrative networks.</a> <em>J Chem Neuroanat</em> 26, 317–330.
</div>
<div id="ref-Hershey2008" class="csl-entry" role="listitem">
Hershey, T., Wu, J., Weaver, P. M., Perantie, D. C., Karimi, M., Tabbal, S. D., et al. (2008). Unilateral vs. Bilateral STN DBS effects on working memory and motor function in parkinson disease. <em>Exp Neurol</em> 210, 402–408. doi:<a href="https://doi.org/10.1016/j.expneurol.2007.11.011">10.1016/j.expneurol.2007.11.011</a>.
</div>
<div id="ref-Hirata2010" class="csl-entry" role="listitem">
Hirata, A., and Castro-Alamancos, M. A. (2010). Neocortex network activation and deactivation states controlled by the thalamus. <em>J Neurophysiol</em> 103, 1147–1157. doi:<a href="https://doi.org/10.1152/jn.00955.2009">10.1152/jn.00955.2009</a>.
</div>
<div id="ref-Hochreiter1997" class="csl-entry" role="listitem">
Hochreiter, S., and Schmidhuber, J. (1997). <span class="nocase">Long short-term memory.</span> <em>Neural Comput.</em> 9, 1735–80. Available at: <a href="http://www.ncbi.nlm.nih.gov/pubmed/9377276">http://www.ncbi.nlm.nih.gov/pubmed/9377276</a>.
</div>
<div id="ref-Hollerman1998" class="csl-entry" role="listitem">
Hollerman, J. R., and Schultz, W. (1998). <span class="nocase">Dopamine neurons report an error in the temporal prediction of reward during learning.</span> <em>Nat. Neurosci.</em> 1, 304–9. doi:<a href="https://doi.org/10.1038/1124">10.1038/1124</a>.
</div>
<div id="ref-Holroyd2002" class="csl-entry" role="listitem">
Holroyd, C. B., and Coles, M. G. H. (2002). <a href="https://www.ncbi.nlm.nih.gov/pubmed/12374324">The neural basis of human error processing: Reinforcement learning, dopamine, and the error-related negativity.</a> <em>Psychol Rev</em> 109, 679–709.
</div>
<div id="ref-Horvitz2009" class="csl-entry" role="listitem">
Horvitz, J. C. (2009). Stimulus-response and response-outcome learning mechanisms in the striatum. <em>Behav Brain Res</em> 199, 129–140. doi:<a href="https://doi.org/10.1016/j.bbr.2008.12.014">10.1016/j.bbr.2008.12.014</a>.
</div>
<div id="ref-Izquierdo2006" class="csl-entry" role="listitem">
Izquierdo, A., Wiedholz, L. M., Millstein, R. A., Yang, R. J., Bussey, T. J., Saksida, L. M., et al. (2006). Genetic and dopaminergic modulation of reversal learning in a touchscreen-based operant procedure for mice. <em>Behav Brain Res</em> 171, 181–188. doi:<a href="https://doi.org/10.1016/j.bbr.2006.03.029">10.1016/j.bbr.2006.03.029</a>.
</div>
<div id="ref-Joel2000" class="csl-entry" role="listitem">
Joel, D., and Weiner, I. (2000). <a href="https://www.ncbi.nlm.nih.gov/pubmed/10717427">The connections of the dopaminergic system with the striatum in rats and primates: An analysis with respect to the functional and compartmental organization of the striatum.</a> <em>Neuroscience</em> 96, 451–474.
</div>
<div id="ref-Jonides1998" class="csl-entry" role="listitem">
Jonides, J., Schumacher, E. H., Smith, E. E., Koeppe, R. A., Awh, E., Reuter-Lorenz, P. A., et al. (1998). <a href="https://www.ncbi.nlm.nih.gov/pubmed/9634568">The role of parietal cortex in verbal working memory.</a> <em>J Neurosci</em> 18, 5026–5034.
</div>
<div id="ref-Kita2005" class="csl-entry" role="listitem">
Kita, H., Tachibana, Y., Nambu, A., and Chiken, S. (2005). Balance of monosynaptic excitatory and disynaptic inhibitory responses of the globus pallidus induced after stimulation of the subthalamic nucleus in the monkey. <em>J Neurosci</em> 25, 8611–8619. doi:<a href="https://doi.org/10.1523/JNEUROSCI.1719-05.2005">10.1523/JNEUROSCI.1719-05.2005</a>.
</div>
<div id="ref-Kleiner-Fisman2006" class="csl-entry" role="listitem">
Kleiner-Fisman, G., Herzog, J., Fisman, D. N., Tamma, F., Lyons, K. E., Pahwa, R., et al. (2006). Subthalamic nucleus deep brain stimulation: Summary and meta-analysis of outcomes. <em>Mov Disord</em> 21 Suppl 14, S290–S304. doi:<a href="https://doi.org/10.1002/mds.20962">10.1002/mds.20962</a>.
</div>
<div id="ref-Koetter1994" class="csl-entry" role="listitem">
Kötter, R. (1994). <a href="https://www.ncbi.nlm.nih.gov/pubmed/7831476">Postsynaptic integration of glutamatergic and dopaminergic signals in the striatum.</a> <em>Prog Neurobiol</em> 44, 163–196.
</div>
<div id="ref-Krueger2009" class="csl-entry" role="listitem">
Krueger, K. A., and Dayan, P. (2009). Flexible shaping: How learning in small steps helps. <em>Cognition</em> 110, 380–394. doi:<a href="https://doi.org/10.1016/j.cognition.2008.11.014">10.1016/j.cognition.2008.11.014</a>.
</div>
<div id="ref-Lange1976" class="csl-entry" role="listitem">
Lange, H., Thorner, G., and Hopf, A. (1976). <a href="https://www.ncbi.nlm.nih.gov/pubmed/965719">[Morphometric-statistical structure analysis of human striatum, pallidum and nucleus su-thalamicus. III. Nucleus subthalamicus].</a> <em>J Hirnforsch</em> 17, 31–41.
</div>
<div id="ref-Lee2007" class="csl-entry" role="listitem">
Lee, B., Groman, S., London, E. D., and Jentsch, J. D. (2007). Dopamine D2/D3 receptors play a specific role in the reversal of a learned visual discrimination in monkeys. <em>Neuropsychopharmacology</em> 32, 2125–2134. doi:<a href="https://doi.org/10.1038/sj.npp.1301337">10.1038/sj.npp.1301337</a>.
</div>
<div id="ref-Luciana1998" class="csl-entry" role="listitem">
Luciana, M., and Nelson, C. A. (1998). <a href="https://www.ncbi.nlm.nih.gov/pubmed/9622192">The functional emergence of prefrontally-guided working memory systems in four- to eight-year-old children.</a> <em>Neuropsychologia</em> 36, 273–293.
</div>
<div id="ref-Matsuda2009" class="csl-entry" role="listitem">
Matsuda, W., Furuta, T., Nakamura, K. C., Hioki, H., Fujiyama, F., Arai, R., et al. (2009). Single nigrostriatal dopaminergic neurons form widely spread and highly dense axonal arborizations in the neostriatum. <em>J Neurosci</em> 29, 444–453. doi:<a href="https://doi.org/10.1523/JNEUROSCI.4029-08.2009">10.1523/JNEUROSCI.4029-08.2009</a>.
</div>
<div id="ref-McNab2008" class="csl-entry" role="listitem">
McNab, F., and Klingberg, T. (2008). Prefrontal cortex and basal ganglia control access to working memory. <em>Nat Neurosci</em> 11, 103–107. doi:<a href="https://doi.org/10.1038/nn2024">10.1038/nn2024</a>.
</div>
<div id="ref-Melchitzky2001" class="csl-entry" role="listitem">
Melchitzky, D. S., and Lewis, D. A. (2001). <a href="https://www.ncbi.nlm.nih.gov/pubmed/11301210">Dopamine transporter-immunoreactive axons in the mediodorsal thalamic nucleus of the macaque monkey.</a> <em>Neuroscience</em> 103, 1033–1042.
</div>
<div id="ref-Mena-Segovia2004" class="csl-entry" role="listitem">
Mena-Segovia, J., Bolam, J. P., and Magill, P. J. (2004). Pedunculopontine nucleus and basal ganglia: Distant relatives or part of the same family? <em>Trends Neurosci</em> 27, 585–588. doi:<a href="https://doi.org/10.1016/j.tins.2004.07.009">10.1016/j.tins.2004.07.009</a>.
</div>
<div id="ref-Miyachi2006" class="csl-entry" role="listitem">
Miyachi, S., Lu, X., Imanishi, M., Sawada, K., Nambu, A., and Takada, M. (2006). Somatotopically arranged inputs from putamen and subthalamic nucleus to primary motor cortex. <em>Neurosci Res</em> 56, 300–308. doi:<a href="https://doi.org/10.1016/j.neures.2006.07.012">10.1016/j.neures.2006.07.012</a>.
</div>
<div id="ref-Nambu2002" class="csl-entry" role="listitem">
Nambu, A., Kaneda, K., Tokuno, H., and Takada, M. (2002). <a href="https://www.ncbi.nlm.nih.gov/pubmed/12364509">Organization of corticostriatal motor inputs in monkey putamen.</a> <em>J Neurophysiol</em> 88, 1830–1842.
</div>
<div id="ref-OReilly2006" class="csl-entry" role="listitem">
O’Reilly, R. C., and Frank, M. J. (2006). <span class="nocase">Making working memory work: a computational model of learning in the prefrontal cortex and basal ganglia.</span> <em>Neural Comput.</em> 18, 283–328. doi:<a href="https://doi.org/10.1162/089976606775093909">10.1162/089976606775093909</a>.
</div>
<div id="ref-Obeso2006" class="csl-entry" role="listitem">
Obeso, J. A., Rodriguez-Oroz, M. C., Javier Blesa, F., and Guridi, J. (2006). The globus pallidus pars externa and parkinson’s disease. Ready for prime time? <em>Exp Neurol</em> 202, 1–7. doi:<a href="https://doi.org/10.1016/j.expneurol.2006.07.004">10.1016/j.expneurol.2006.07.004</a>.
</div>
<div id="ref-Oja1982" class="csl-entry" role="listitem">
Oja, E. (1982). <span class="nocase">A simplified neuron model as a principal component analyzer.</span> <em>J. Math. Biol.</em> 15, 267–73. Available at: <a href="http://www.ncbi.nlm.nih.gov/pubmed/7153672">http://www.ncbi.nlm.nih.gov/pubmed/7153672</a>.
</div>
<div id="ref-Owen1999" class="csl-entry" role="listitem">
Owen, A. M., Herrod, N. J., Menon, D. K., Clark, J. C., Downey, S. P., Carpenter, T. A., et al. (1999). <a href="https://www.ncbi.nlm.nih.gov/pubmed/10051756">Redefining the functional organization of working memory processes within human lateral prefrontal cortex.</a> <em>Eur J Neurosci</em> 11, 567–574.
</div>
<div id="ref-Packard2002" class="csl-entry" role="listitem">
Packard, M. G., and Knowlton, B. J. (2002). Learning and memory functions of the basal ganglia. <em>Annu Rev Neurosci</em> 25, 563–593. doi:<a href="https://doi.org/10.1146/annurev.neuro.25.112701.142937">10.1146/annurev.neuro.25.112701.142937</a>.
</div>
<div id="ref-Parent1995" class="csl-entry" role="listitem">
Parent, A., and Hazrati, L. N. (1995). Functional anatomy of the basal ganglia. <span>I. The</span> cortico-basal ganglia-thalamo-cortical loop. <em>Brain Res Brain Res Rev</em> 20, 91–127.
</div>
<div id="ref-Pozo2010" class="csl-entry" role="listitem">
Pozo, K., and Goda, Y. (2010). Unraveling mechanisms of homeostatic synaptic plasticity. <em>Neuron</em> 66, 337–351. doi:<a href="https://doi.org/10.1016/j.neuron.2010.04.028">10.1016/j.neuron.2010.04.028</a>.
</div>
<div id="ref-Redgrave2010" class="csl-entry" role="listitem">
Redgrave, P., Rodriguez, M., Smith, Y., Rodriguez-Oroz, M. C., Lehericy, S., Bergman, H., et al. (2010). Goal-directed and habitual control in the basal ganglia: Implications for parkinson’s disease. <em>Nat Rev Neurosci</em> 11, 760–772. doi:<a href="https://doi.org/10.1038/nrn2915">10.1038/nrn2915</a>.
</div>
<div id="ref-Repovs2006" class="csl-entry" role="listitem">
Repovs, G., and Baddeley, A. (2006). The multi-component model of working memory: Explorations in experimental cognitive psychology. <em>Neuroscience</em> 139, 5–21. doi:<a href="https://doi.org/10.1016/j.neuroscience.2005.12.061">10.1016/j.neuroscience.2005.12.061</a>.
</div>
<div id="ref-Reynolds2002" class="csl-entry" role="listitem">
Reynolds, J. N. J., and Wickens, J. R. (2002). <span class="nocase">Dopamine-dependent plasticity of corticostriatal synapses</span>. <em>Neural Networks</em> 15, 507–521. Available at: <a href="http://www.sciencedirect.com/science/article/pii/S089360800200045X">http://www.sciencedirect.com/science/article/pii/S089360800200045X</a>.
</div>
<div id="ref-Reynolds2001" class="csl-entry" role="listitem">
Reynolds, J. N., Hyland, B. I., and Wickens, J. R. (2001). A cellular mechanism of reward-related learning. <em>Nature</em> 413, 67–70. doi:<a href="https://doi.org/10.1038/35092560">10.1038/35092560</a>.
</div>
<div id="ref-Rowe2000" class="csl-entry" role="listitem">
Rowe, J. B., Toni, I., Josephs, O., Frackowiak, R. S., and Passingham, R. E. (2000). <a href="https://www.ncbi.nlm.nih.gov/pubmed/10834847">The prefrontal cortex: Response selection or maintenance within working memory?</a> <em>Science</em> 288, 1656–1660.
</div>
<div id="ref-Sanchez-Gonzalez2005" class="csl-entry" role="listitem">
Sánchez-González, M. A., Garcı́a-Cabezas, M. A., Rico, B., and Cavada, C. (2005). The primate thalamus is a key target for brain dopamine. <em>J Neurosci</em> 25, 6076–6083. doi:<a href="https://doi.org/10.1523/JNEUROSCI.0968-05.2005">10.1523/JNEUROSCI.0968-05.2005</a>.
</div>
<div id="ref-Schultz1997" class="csl-entry" role="listitem">
Schultz, W., Dayan, P., and Montague, P. R. (1997). <span class="nocase">A neural substrate of prediction and reward.</span> <em>Science</em> 275, 1593–9. Available at: <a href="http://www.ncbi.nlm.nih.gov/pubmed/9054347">http://www.ncbi.nlm.nih.gov/pubmed/9054347</a>.
</div>
<div id="ref-Seamans2004" class="csl-entry" role="listitem">
Seamans, J. K., and Yang, C. R. (2004). <span class="nocase">The principal features and mechanisms of dopamine modulation in the prefrontal cortex.</span> <em>Prog. Neurobiol.</em> 74, 1–58. doi:<a href="https://doi.org/10.1016/j.pneurobio.2004.05.006">10.1016/j.pneurobio.2004.05.006</a>.
</div>
<div id="ref-Seger2008" class="csl-entry" role="listitem">
Seger, C. A. (2008). How do the basal ganglia contribute to categorization? <span>Their </span>roles in generalization, response selection, and learning via feedback. <em>Neurosci Biobehav Rev</em> 32, 265–278. doi:<a href="https://doi.org/10.1016/j.neubiorev.2007.07.010">10.1016/j.neubiorev.2007.07.010</a>.
</div>
<div id="ref-Shen2008" class="csl-entry" role="listitem">
Shen, W., Flajolet, M., Greengard, P., and Surmeier, D. J. (2008). <span class="nocase">Dichotomous dopaminergic control of striatal synaptic plasticity.</span> <em>Science</em> 321, 848–51. doi:<a href="https://doi.org/10.1126/science.1160575">10.1126/science.1160575</a>.
</div>
<div id="ref-Skinner1938" class="csl-entry" role="listitem">
Skinner, B. F. (1938). <em>The behavior of organisms</em>. New York: Appleton-Century-Crofts.
</div>
<div id="ref-Suzuki2001" class="csl-entry" role="listitem">
Suzuki, T., Miura, M., Nishimura, K., and Aosaki, T. (2001). <a href="https://www.ncbi.nlm.nih.gov/pubmed/11517238">Dopamine-dependent synaptic plasticity in the striatal cholinergic interneurons.</a> <em>J Neurosci</em> 21, 6492–6501.
</div>
<div id="ref-Takada1998" class="csl-entry" role="listitem">
Takada, M., Tokuno, H., Nambu, A., and Inase, M. (1998). <a href="https://www.ncbi.nlm.nih.gov/pubmed/9628410">Corticostriatal projections from the somatic motor areas of the frontal cortex in the macaque monkey: Segregation versus overlap of input zones from the primary motor cortex, the supplementary motor area, and the premotor cortex.</a> <em>Exp Brain Res</em> 120, 114–128.
</div>
<div id="ref-Tanimura2011" class="csl-entry" role="listitem">
Tanimura, Y., King, M. A., Williams, D. K., and Lewis, M. H. (2011). Development of repetitive behavior in a mouse model: Roles of indirect and striosomal basal ganglia pathways. <em>Int J Dev Neurosci</em> 29, 461–467. doi:<a href="https://doi.org/10.1016/j.ijdevneu.2011.02.004">10.1016/j.ijdevneu.2011.02.004</a>.
</div>
<div id="ref-vanderMeulen2007" class="csl-entry" role="listitem">
van der Meulen, J. A. J., Joosten, R. N. J. M. A., de Bruin, J. P. C., and Feenstra, M. G. P. (2007). Dopamine and noradrenaline efflux in the medial prefrontal cortex during serial reversals and extinction of instrumental goal-directed behavior. <em>Cereb Cortex</em> 17, 1444–1453. doi:<a href="https://doi.org/10.1093/cercor/bhl057">10.1093/cercor/bhl057</a>.
</div>
<div id="ref-Vijayraghavan2007" class="csl-entry" role="listitem">
Vijayraghavan, S., Wang, M., Birnbaum, S. G., Williams, G. V., and Arnsten, A. F. T. (2007). Inverted-u dopamine D1 receptor actions on prefrontal neurons engaged in working memory. <em>Nat Neurosci</em> 10, 376–384. doi:<a href="https://doi.org/10.1038/nn1846">10.1038/nn1846</a>.
</div>
<div id="ref-Vitay2010" class="csl-entry" role="listitem">
Vitay, J., and Hamker, F. H. (2010). <span class="nocase">A computational model of Basal Ganglia and its role in memory retrieval in rewarded visual memory tasks.</span> <em>Front. Comput. Neurosci.</em> 4. doi:<a href="https://doi.org/10.3389/fncom.2010.00013">10.3389/fncom.2010.00013</a>.
</div>
<div id="ref-Voorn2004" class="csl-entry" role="listitem">
Voorn, P., Vanderschuren, L. J. M. J., Groenewegen, H. J., Robbins, T. W., and Pennartz, C. M. A. (2004). Putting a spin on the dorsal-ventral divide of the striatum. <em>Trends Neurosci</em> 27, 468–474. doi:<a href="https://doi.org/10.1016/j.tins.2004.06.006">10.1016/j.tins.2004.06.006</a>.
</div>
<div id="ref-Winn2006" class="csl-entry" role="listitem">
Winn, P. (2006). How best to consider the structure and function of the pedunculopontine tegmental nucleus: Evidence from animal studies. <em>J Neurol Sci</em> 248, 234–250. doi:<a href="https://doi.org/10.1016/j.jns.2006.05.036">10.1016/j.jns.2006.05.036</a>.
</div>
<div id="ref-Witt2004" class="csl-entry" role="listitem">
Witt, K., Pulkowski, U., Herzog, J., Lorenz, D., Hamel, W., Deuschl, G., et al. (2004). Deep brain stimulation of the subthalamic nucleus improves cognitive flexibility but impairs response inhibition in parkinson disease. <em>Arch Neurol</em> 61, 697–700. doi:<a href="https://doi.org/10.1001/archneur.61.5.697">10.1001/archneur.61.5.697</a>.
</div>
<div id="ref-Yoshioka1996" class="csl-entry" role="listitem">
Yoshioka, M., Matsumoto, M., Togashi, H., and Saito, H. (1996). <a href="https://www.ncbi.nlm.nih.gov/pubmed/8736645">Effect of conditioned fear stress on dopamine release in the rat prefrontal cortex.</a> <em>Neurosci Lett</em> 209, 201–203.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./3-FICN.html" class="pagination-link" aria-label="A computational model of basal ganglia and its role in memory retrieval in rewarded visual memory tasks">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A computational model of basal ganglia and its role in memory retrieval in rewarded visual memory tasks</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./5-FINR.html" class="pagination-link" aria-label="Timing and expectation of reward: a neuro-computational model of the afferents to the ventral tegmental area">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Timing and expectation of reward: a neuro-computational model of the afferents to the ventral tegmental area</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>